import matplotlib.pyplot as plt
import torch
import numpy as np
from math import *

itr_uot1_4096 = [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980, 990, 1000]
mmd_uot1_4096 = [0.22349096782088085, 0.07224075275094173, 0.04150363007866337, 0.020096008748903327, 0.007380427511208404, 0.002319033880432614, 0.001852450210194534, 0.001798096501005847, 0.0010315020778376427, 0.0009748857832216073, 0.001180621028544021, 0.001236860855867078, 0.0006105490359890886, 0.0003880999161172405, 0.00022796950245440595, 0.00034622631691544337, 0.00044633668822813277, 0.0009970499007957434, 0.0007088311654736557, 0.00022622660093760127, 0.00021993196471206677, 0.00013496468393961458, 0.0003523823764148559, 0.00046506200301316136, 0.0010940977542269192, 0.000641385572124703, 0.00012873525239592842, 0.00013672565007119553, 0.0006335864375836275, 0.0002766428024630063, 0.00044375313269756633, 0.00045321277844834196, 0.0001883098310134501, 0.00027277955326468484, 0.00034965983791138133, 0.00042762795154774325, 0.0005200324514730847, 0.0003936967743917996, 0.00012078210524266164, 0.00032217774076923056, 0.0002370761468004634, 0.0005289931428988648, 0.00034305554885497025, 0.000663572447512556, 0.0004437687860505135, 0.00026191537122510766, 0.0003035738247490205, 0.00029704131039581805, 0.0006163185920136927, 0.0002618858381567557, 0.0006488568365551617, 0.0004904617402736178, 0.0005994438411231484, 0.00034561659542078904, 0.00018373345552935572, 0.0003090432314666325, 0.00021008828669613622, 0.00044911588703280825, 0.00021041222293557982, 0.000593460464469564, 0.0007085263138759956, 0.0009530257877372328, 0.0006300626505129359, 0.0008128392760016756, 0.00017952222455244748, 0.00034108627397652636, 0.00040931994374085456, 0.0014264857420725197, 0.00014064189472265398, 0.0003316083995368868, 0.0003788279890652724, 0.0004993815972758053, 0.00021003144777892446, 0.00023728037399123325, 0.0004900579696584528, 0.00011579332246264284, 0.00031923442104522803, 0.000432692233429649, 0.00023739662471197742, 0.00025930377023808404, 0.0005381831340600662, 0.0003407436494667626, 0.0004814842595500246, 0.00021026228622336718, 0.00032013648998643895, 0.00023141430156323195, 0.0003147394788464708, 0.0002712535206731703, 0.0004516390303601625, 0.0005645615124988956, 0.0006916939963133861, 0.00012287275475453274, 0.0006570011893693162, 0.0005517619665341145, 0.000396190953948411, 0.00035299804609281726, 0.00022549410928374147, 0.00040417441561926837, 0.00035056563259039386, 0.0005138713988266097]
itr_uot2_4096 = [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980, 990, 1000]
mmd_uot2_4096 = [0.2141193161508753, 0.07774082402479915, 0.04685408492786605, 0.021053162689048666, 0.005622051160732222, 0.0029550062878139216, 0.0009499924616363509, 0.0008401005380871684, 0.0003581817440249102, 0.0003529204564607369, 0.0005094391250083374, 0.0005436141717311826, 0.0007574332451859844, 0.0007914372424662475, 0.00033221973059577303, 0.0011932120533238721, 0.00041639743131471896, 0.0006013689945685852, 0.0001702136218165451, 0.0004567419056774602, 0.000960741158915035, 0.0008597980191871468, 0.0010956368181721243, 0.0006134329227285018, 0.0002896633786589886, 0.00014625907640986036, 0.0002298575829375593, 0.00029575961103006643, 0.0002588112739353998, 0.000805524745370434, 0.00030323723091560395, 0.00024758219968623596, 0.0006164318846367256, 0.0007469023595299551, 0.000345314530290991, 0.00032089613438746056, 0.0010571344515644954, 0.00039598387392886236, 0.0010638150804075652, 0.0005848271466009081, 0.000315461501884412, 0.0008394089974025354, 0.0006078780701332942, 0.0003515089461227916, 0.0004132421445499357, 0.00015421184712427483, 0.0003048401557404212, 0.0007296932450191473, 0.00029746720821915984, 0.0006405203455969455, 0.0004322897736234177, 0.0006002022461987777, 0.0004945259698538595, 0.0003023213034087091, 0.00039202988039896414, 0.0005361137541340932, 0.0016820146436923589, 0.0014158872185414118, 0.0004382748517603452, 0.0005113094262196582, 0.00023432170403586694, 0.00043614253185564333, 0.0005914238734986421, 0.0004685851128198304, 0.0003365867452898297, 0.0003772736616729777, 0.0005216820912942455, 0.0005805313062485218, 0.0005588516910141339, 0.00030045816585719254, 0.00047771060380946695, 0.0004028652504649566, 0.0005732649749976004, 0.0011193029511901986, 0.0010641421669517481, 0.0003733044567331978, 0.0005031340753307578, 0.00046928927547268406, 0.0005027002694692195, 0.0006186531235568282, 0.00037673663763357346, 0.0005539355798966639, 0.0010243231524965646, 0.0008989194471171191, 0.0006043432324092934, 0.0008042829796776341, 0.000518956427958267, 0.00016404602155217773, 0.0004491688423636231, 0.0003358429939052665, 0.0005173273989987071, 0.000889023793412741, 0.00036426888784046874, 0.00017040333732276647, 0.00034696800788944215, 0.0007541815958307385, 0.000761978136015945, 0.000369393383476746, 0.0003238213916420263, 0.00022728789411460837]


itr_ot1_4096=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980, 990, 1000]
mmd_ot1_4096=[0.14143500882331636, 0.09168098880271572, 0.02612376422506285, 0.0026375951600746406, 0.0032339702170363915, 0.002717052781582907, 0.0012621976821790837, 0.0012846544253923287, 0.0008211981986178396, 0.0007426291199217616, 0.001114986516438654, 0.0013364127178334684, 0.0010652731480186306, 0.0007059947600080718, 0.0008083373408046823, 0.0011060204855371236, 0.0010149763018753866, 0.000990482624145278, 0.001096898670392893, 0.0011217770368298352, 0.0010454931545163249, 0.0012239894661504602, 0.0008321417157927113, 0.0006905685255085281, 0.0006656397574798245, 0.0006558869251162558, 0.0008697010026290086, 0.0005882077132278174, 0.0007793213187724524, 0.0005924803035798898, 0.0007450539613890195, 0.0007531136856735454, 0.0008298016452104318, 0.0005867534269495267, 0.0007058411735798298, 0.0008374651558520074, 0.0009343845526464667, 0.0006025230301921203, 0.0007414315537789262, 0.0007307904600034332, 0.0009714646230556956, 0.000979160807306978, 0.0007579452407108223, 0.0005991372312669774, 0.0004973927449526683, 0.0008845108586879591, 0.0009865000225172949, 0.000777250947554653, 0.0007414604675935188, 0.0005979343625918399, 0.0009442451293946441, 0.0010844584044306382, 0.0006785831986317603, 0.0007266549014926238, 0.0010394772247403206, 0.001183067290027373, 0.0008114911330815433, 0.0005911613101752811, 0.000631120012157288, 0.0007076637073251124, 0.000670786282379654, 0.0007063832334145703, 0.00041184004645994365, 0.0007149390332702454, 0.0007386546016178164, 0.0006613052603406944, 0.0006142076060243196, 0.0003662955809900781, 0.0003799307356561199, 0.00042315273969875666, 0.0006809596471421542, 0.0007635959155257166, 0.0005100477033110062, 0.0005093888707247418, 0.0007130831498161905, 0.0005892141556298747, 0.0006189188307119398, 0.00042562021003331174, 0.00043973401035629633, 0.00035709821063245606, 0.0004424048788305712, 0.0004392237625634454, 0.0004591841244919459, 0.00036855209498665165, 0.0004998063755343174, 0.0005575413219403857, 0.0005985964121535403, 0.0003844545983056613, 0.0004811765264301493, 0.0004055504375028718, 0.0006781378080805145, 0.0006551939878332302, 0.0005381420281073968, 0.0006582509598197783, 0.00043295571833851243, 0.00042764809213988175, 0.0005332360644788592, 0.000462576295557543, 0.0005224971962553282, 0.00038044468568981804]

itr_ot2_4096=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980, 990, 1000]
mmd_ot2_4096=[0.16792399678949352, 0.04953986953287082, 0.00451287678715287, 0.013653958524797616, 0.00672443151491961, 0.002461973564091946, 0.000708028097965302, 0.0006896144393408188, 0.0006485531258033361, 0.0006248132593577593, 0.0005691028511591867, 0.0006812286360911579, 0.0006240426408976041, 0.0006178597053917712, 0.0006167262325055822, 0.000392933182370131, 0.00029629004936848613, 0.0009632535433047595, 0.0004968002233601554, 0.0006493563222466081, 0.0005403640777922047, 0.00032707144012417144, 0.00036762918320387694, 0.0004242995037071762, 0.000261637554976879, 0.00023848392178929534, 0.00039147988881149676, 0.00013662756976143275, 0.00012983695917678784, 0.00012021599384748338, 0.0002562264494508637, 0.0008842022552039419, 0.0007086960949481969, 0.00044037991446199687, 0.00034261428622808787, 0.00038068091534115833, 0.0002616161618323176, 0.00019673038350220828, 0.00019874603663766477, 0.00019293737427683588, 0.0004053947000300928, 0.0003273964166316812, 0.00014119685084093558, 0.0002910179773630006, 0.00024195356596692918, 0.0008027570254710847, 0.0004774801328210343, 0.0008603181257717529, 0.0005071882282947915, 0.0005115404227421794, 0.0003111640862880627, 0.0003278360260287605, 0.00028662796320527706, 0.000303923872154388, 0.0006315869273998687, 0.0006920424214240106, 0.00047227214979100873, 0.000284118447578946, 0.0003657042525588572, 0.0002891236428399502, 0.00039521799544559033, 0.0004418616917490348, 0.00026539491245100577, 0.0003596178259385463, 0.00033521046109599717, 0.00037556320186463155, 0.0003310706796809948, 0.000893861027392362, 0.0006448379466268694, 0.0004814216802617455, 0.0003664616826005995, 0.0006262111010028049, 0.00040294076098232323, 0.00024296996044537167, 0.00023083513596472427, 0.0002559370321455201, 0.0001959320301603007, 0.0006553461086281076, 0.0005100763644031725, 0.0003532185919493669, 0.0002772953961687197, 0.00039968721127989215, 0.0002566601970232507, 0.00021328341121062966, 0.00016476936383924556, 0.0002817702781339748, 0.0003140774308690031, 0.00029982266359354637, 0.00037613937362945826, 0.00020188286684030832, 0.0002478664920886331, 0.0003064987908077965, 0.0002967565927866622, 0.00047613169385526954, 0.0002751432220924055, 0.0004114292913720563, 0.00042960334873271, 0.000322380864788252, 0.00025317278401643106, 0.0003730581636238739]

itr_ot1_256=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980, 990, 1000]
mmd_ot1_256=[0.1658811815767096, 0.07400868533296259, 0.02493113042869935, 0.00915355892725303, 0.014084652931878716, 0.007559692789502304, 0.01441446263373336, 0.012370927663807818, 0.004111448076860397, 0.0031945518923612304, 0.008728509518336952, 0.006919172899814585, 0.012841374368424252, 0.007930006411163454, 0.00827728237529754, 0.0018576452446927572, 0.004625250474518866, 0.002395856407988506, 0.0018881481145308077, 0.002486654264830551, 0.0010067506261316195, 0.0006214978163272544, 0.0018422952797655379, 0.0016100780845454132, 0.002233066883321727, 0.008413596757909536, 0.0048262285737257216, 0.0015420316648498689, 0.0017526053100527517, 0.0023387393353914154, 0.0023035757287925285, 0.002352830368860165, 0.0029591461457641743, 0.0037801454641658017, 0.004068140487242966, 0.00449279396256258, 0.005410901884185915, 0.0014975341093440842, 0.000991957244261793, 0.0012301081583631912, 0.002379616545244989, 0.004831061535434722, 0.0018758639127963717, 0.002142212753670908, 0.0012969848413751928, 0.0009403644726819205, 0.001962359205198244, 0.002042653353568097, 0.0009016472780740137, 0.0016054161483406992, 0.0011730544575038748, 0.0009495162174027738, 0.0012059338899143568, 0.0037932495514166886, 0.003858717087246083, 0.005038376749448625, 0.006757737605220165, 0.0050523600078679065, 0.0017308603893490815, 0.0011342483321038765, 0.004325099968087859, 0.0034999376085488587, 0.0013665135960542474, 0.0023149414473664365, 0.002407228409973622, 0.0034328826455816697, 0.004914018328132624, 0.00585389371630754, 0.007307006949619083, 0.008165584445380791, 0.002885706482998074, 0.00208346509459717, 0.0020787241683262736, 0.002395605583991489, 0.001976817909564943, 0.0031860580381577186, 0.0021966056170845127, 0.0015535427149700465, 0.0015194827573032088, 0.002522972310825905, 0.0019127866837811702, 0.001549237262784109, 0.0017900517724001308, 0.0022272678052081274, 0.0016615202861566813, 0.0015257858190227402, 0.0018964402227288346, 0.0031135967330009895, 0.003862936149211016, 0.0036389246855091095, 0.001418719598980267, 0.0014636932498180155, 0.0010438041548695431, 0.0009742584589491621, 0.0009810152414138074, 0.0009903167498896137, 0.001707900788535388, 0.0017433600452398113, 0.001616307766621472, 0.001360318947818101]

itr_uot1_256=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980, 990, 1000]
mmd_uot1_256=[0.1632812439246019, 0.022719000307448306, 0.012074162963931295, 0.002161541064649497, 0.009341644449388925, 0.0037415324823697194, 0.004672845747768967, 0.006839077970186264, 0.0061960696845700935, 0.002652527128541693, 0.007730009066023336, 0.006619854626121385, 0.007161922834106327, 0.002584060432958557, 0.003683412399826086, 0.0010572563723101058, 0.0029396801043722887, 0.005160357521097947, 0.006180270869822674, 0.007240034537858209, 0.0022799428171335623, 0.0005567188331676576, 0.0014988197535144576, 0.003813489766296918, 0.004845451743153512, 0.0038086522589586835, 0.0054603568501217226, 0.00498864781221775, 0.009507380309135505, 0.007095616527452636, 0.010595641058712996, 0.009917376060609079, 0.012139612553439594, 0.0073899886137907544, 0.009323259593226746, 0.001732012681121109, 0.0024632602057883257, 0.007192126942551835, 0.005906193758567907, 0.005303451436752149, 0.005856625436192947, 0.004192151799609356, 0.0023908668897815732, 0.0014390704870474724, 0.0010714097266549816, 0.0022297214644972363, 0.0012729168179238526, 0.009502065730603249, 0.009448372486224793, 0.005255947077337231, 0.0014616968714948053, 0.0020522797735366416, 0.00481491614789889, 0.003719873827242731, 0.003972786636428444, 0.004024694308073229, 0.0035410787535512245, 0.005841493936748349, 0.004770401866821955, 0.005548781714454609, 0.010204324342209636, 0.011306195275847475, 0.004190419360448144, 0.001890136256971292, 0.004843978354013151, 0.0016997136178301397, 0.0032681647735289254, 0.0033675942608699105, 0.0055108154307889345, 0.004110556691175216, 0.0021036196752615144, 0.0010929290188564644, 0.0019368498985272709, 0.0012130192385594596, 0.001031459091731135, 0.005066358634467499, 0.004457527001412803, 0.0024580422280601755, 0.0028800324367852237, 0.004922550552510313, 0.010011162396699719, 0.015858956677283848, 0.009723596648768762, 0.003381243185445193, 0.0031788209605933815, 0.003812336912950187, 0.004049940392772872, 0.0014291971906937873, 0.007763213443335637, 0.006632392110520746, 0.004125313186283841, 0.003015720235369196, 0.002945400330523984, 0.0015857927702525032, 0.0010247938079591679, 0.0027686764089163984, 0.006431599493951418, 0.0055770254236910954, 0.004120946956827409, 0.0018035617838919882]

# t=5
# plt.plot(itr_ot1_4096[t:], mmd_ot1_4096[t:], label='OT1')
# plt.plot(itr_uot1_4096[t:], mmd_uot1_4096[t:], label='UOT1')
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.legend()
# plt.show()
# plt.plot(itr_ot2_4096[t:], mmd_ot2_4096[t:], label='OT')
# plt.plot(itr_uot2_4096[t:], mmd_uot2_4096[t:], label='UOT')
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.legend()
# plt.show()

# plt.plot(itr_uot2_4096[t:], mmd_uot2_4096[t:], label='UOT2')
# plt.plot(itr_ot2_4096[t:], mmd_ot2_4096[t:], label='OT2')
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.legend()
# plt.show()

# plt.plot(itr_ot1_256[t:], mmd_ot1_256[t:], label='OT_256')
# plt.plot(itr_ot1_4096[t:],mmd_ot1_4096[t:], label='OT_4096')
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.legend()
# plt.show()

# plt.plot(itr_ot1_256[t:], mmd_ot1_256[t:], label='OT_256')
# plt.plot(itr_uot1_256[t:],mmd_uot1_256[t:], label='UOT_256')
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.legend()
# plt.show()

# itr_uot_far = [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980, 990, 1000]
# mmd_uot_far = [0.20208150362856214, 0.022499177896464467, 0.0046637980450521255, 0.05962852395581128, 0.08984108675248087, 0.022973255835279538, 0.023252404431933105, 0.03445950395169617, 0.0199105746395008, 0.025204996294363624, 0.027245135905099693, 0.026352585334438572, 0.016743153686158196, 0.01805662044476164, 0.03068420346786893, 0.014969865400362964, 0.006305604696333816, 0.015291561147269817, 0.009641984801454784, 0.07888917595455835, 0.02899960440649435, 0.0376018218644259, 0.02522572312115845, 0.02201380112029644, 0.02180512613972241, 0.022282288724826516, 0.024506340129543225, 0.0475882516233288, 0.011793841757153006, 0.02940115478669547, 0.021075745241275035, 0.016423027478219804, 0.013120131507537325, 0.012074615899279328, 0.01443830851771688, 0.008159613958544643, 0.010712650608681096, 0.024324661804784847, 0.009918109891772137, 0.016965332733602956, 0.007067941616518109, 0.009035318102158213, 0.010498761927646205, 0.008037132243072537, 0.008744735595328401, 0.007903028552683627, 0.007111756029374083, 0.0030997785142889145, 0.014481826567168898, 0.008340172419891989, 0.009146544182855543, 0.011410946283056833, 0.0075757672522876185, 0.007164939325609659, 0.0071221253961469555, 0.012734907011128865, 0.011400293045846582, 0.013606343654790104, 0.009082875880190217, 0.014645299069248913, 0.012316820499986003, 0.010522786103143639, 0.011103358035097183, 0.011521231002080023, 0.014424250808467876, 0.018799708809073307, 0.014457250729966342, 0.02258378849329834, 0.017946240791726825, 0.02445672331750226, 0.031938115962876185, 0.025080346510622187, 0.02515719279116324, 0.027037482488410702, 0.02921207243849802, 0.02546492484347329, 0.023144684444278307, 0.0192193099173682, 0.02631376902264565, 0.02848479456904271, 0.02274730719084983, 0.027197012493547473, 0.02907945577610105, 0.02250212321268058, 0.025117035345019773, 0.020109964266059904, 0.01855540669153108, 0.020931838050056523, 0.021002462600766325, 0.02711793891964595, 0.02786137549007342, 0.029089584913310818, 0.02913045175230236, 0.03478709854951695, 0.027311339966386655, 0.0319821494100099, 0.034123156354994105, 0.026936303003409434, 0.030078668682417098, 0.024034209975793003]
# itr_ot_far=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 910, 920, 930, 940, 950, 960, 970, 980, 990, 1000]
# mmd_ot_far=[0.18331189761124392, 0.11567056155964207, 0.03330534407451208, 0.01408999745205275, 0.021748313424918703, 0.02081745545626046, 0.011270070385179576, 0.008134930438922772, 0.0022922058385131394, 0.003559184597722642, 0.0021848815664969323, 0.0014332617145488558, 0.001964739467373966, 0.002183124746956616, 0.001596602415510684, 0.0014208161568907696, 0.001517047197061805, 0.0017204230057802916, 0.0015201995035111493, 0.0018405951389893482, 0.0013331197729843647, 0.0013338728389397925, 0.0013878632482013653, 0.0012259526047993796, 0.0013260705449833488, 0.0014062699758964625, 0.0014721855438168119, 0.0018151399771760002, 0.0022109279159047424, 0.0027143558033561888, 0.0018855655182228592, 0.0016360985051702692, 0.0017404372792461098, 0.0014724907830097056, 0.0016332998035193114, 0.0014481311904910033, 0.001710056168712809, 0.0018990587572831341, 0.0017799274427112155, 0.001924070368792885, 0.0017748045240924826, 0.0018783505130192946, 0.0017100059865228223, 0.001767854760261811, 0.0019563630091890827, 0.0015767443305289008, 0.0013923643336186953, 0.0016668203291127504, 0.0016844131253640204, 0.0016526883582098917, 0.0019729992557452614, 0.0020248971402909433, 0.0015841953380733298, 0.0014446362737275953, 0.0016883707006751236, 0.0017060813132914465, 0.0016793777292797296, 0.0016045401422653816, 0.0012518751382200877, 0.0014811455581349164, 0.0013718682545231786, 0.0013583112709417144, 0.0019340696046136474, 0.001998887119107423, 0.0021247221208152145, 0.0015800605705241222, 0.0013889736724741197, 0.0016636878252473952, 0.0016751591354123296, 0.0016173984911486972, 0.0016557527247456627, 0.001757303574106528, 0.001720162440520867, 0.001750923618253436, 0.001727773791862286, 0.0014765017320121365, 0.0014883597010130756, 0.001542847650041701, 0.0016528945004408435, 0.0018035508007641643, 0.0018719012171529714, 0.001595142003807698, 0.0016701116920328773, 0.0019830743076439394, 0.0017683040367260927, 0.0016168107288112299, 0.0016269045195899112, 0.0016538953703505166, 0.0015985226893371896, 0.0015021449632379724, 0.001585824907248068, 0.0016795676731037046, 0.0016968604926932973, 0.0015796573486536736, 0.0013611914742655273, 0.0015986310749646904, 0.0014340662297859796, 0.001623973746980839, 0.0016712775720526263, 0.0018572611284768115]
# plt.plot(itr_ot_far, mmd_ot_far, label="OT_far")
# plt.plot(itr_uot_far, mmd_uot_far, label="UOT_far")
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.legend()
# plt.show()

# 4096 train, 4096 test MMD
# ot_itr=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# ot_mmd=[0.35437431931495667, 0.25018444657325745, 0.22449976205825806, 0.21644985675811768, 0.14288067817687988, 0.20901215076446533, 0.20383170247077942, 0.1392437219619751, 0.1512891948223114, 0.22662675380706787, 0.21190530061721802, 0.147456556558609, 0.1113656759262085, 0.11340510845184326, 0.116753488779068, 0.13632041215896606, 0.13756334781646729, 0.10061049461364746, 0.07339704036712646, 0.06974932551383972, 0.08066320419311523, 0.07724589109420776, 0.05022856593132019, 0.033308833837509155, 0.0648411214351654, 0.05683577060699463, 0.04191514849662781, 0.04429548978805542, 0.012635231018066406, 0.03819990158081055, 0.006765842437744141, 0.030673086643218994, 0.008011579513549805, 0.027793824672698975, 0.010670900344848633, 0.015259265899658203, 0.012368917465209961, 0.007887125015258789, 0.01509469747543335, 0.0031775236129760742, 0.010681390762329102, 0.004228353500366211, 0.009231090545654297, 0.011377573013305664, 0.0020096898078918457, 0.006549954414367676, 0.0022475719451904297, 0.0075154900550842285, 0.004548072814941406, 0.002486109733581543, 0.0017061829566955566, 0.004830598831176758, 0.006126761436462402, 0.0009717941284179688, 0.0028250813484191895, 0.001721203327178955, 0.004271447658538818, 0.0030014514923095703, 0.0014126300811767578, 0.0022319555282592773, 0.0016639232635498047, 0.002749204635620117, 0.0013374090194702148, 0.001644730567932129, 0.0007819533348083496, 0.0033063888549804688, 0.0012674927711486816, 0.0011832714080810547, 0.000910639762878418, 0.0010324716567993164, 0.0025167465209960938, 0.0007942914962768555, 0.0006708502769470215, 0.0011326074600219727, 0.0011093616485595703, 0.001025557518005371, 0.0007581710815429688, 0.0009569525718688965, 0.0014607906341552734, 0.0010527968406677246, 0.0008836984634399414, 0.0005869269371032715, 0.001186966896057129, 0.0009626150131225586, 0.0006802082061767578, 0.0006024837493896484, 0.0015399456024169922, 0.0009643435478210449, 0.0005030632019042969, 0.0006527900695800781, 0.0012049078941345215, 0.0005587935447692871, 0.0003796815872192383, 0.0008263587951660156, 0.0007106661796569824, 0.0009602904319763184, 0.000431060791015625, 0.0004763007164001465, 0.0006275773048400879, 0.00047475099563598633, 0.00033360719680786133, 0.0005818605422973633, 0.0010373592376708984, 0.0006477832794189453, 0.0006973743438720703, 0.0007439851760864258, 0.0005313754081726074, 0.000527799129486084, 0.0008921623229980469, 0.00048089027404785156, 0.0005532503128051758, 0.0003662109375, 0.0004703998565673828, 0.0005929470062255859, 0.0004788637161254883, 0.000763237476348877, 0.0006225109100341797, 0.0008543729782104492, 0.0006850361824035645, 0.0008005499839782715, 0.00044417381286621094, 0.00048422813415527344, 0.000735163688659668, 0.000507652759552002, 0.0005415678024291992, 0.00037872791290283203, 0.0005445480346679688, 0.00043487548828125, 0.0006701946258544922, 0.0003559589385986328, 0.0005360841751098633, 0.0005269050598144531, 0.000516057014465332, 0.0006804466247558594, 0.0002676844596862793, 0.0001437664031982422, 0.00041872262954711914, 0.00037598609924316406, 0.0008954405784606934, 0.000408172607421875, 0.00039589405059814453, 0.0007088184356689453, 0.0008454322814941406, 0.0007073879241943359, 0.0007644891738891602, 0.0002276897430419922, 9.363889694213867e-05, 0.00015497207641601562, 0.00041174888610839844, 0.0003230571746826172, 0.00028765201568603516, 0.0005254745483398438, 0.00034677982330322266, 0.0002886056900024414, 0.00043886899948120117, 0.0003249645233154297, 0.000541985034942627, 0.00027382373809814453, 0.0003324151039123535, 0.0003504753112792969, 0.00037086009979248047, 0.0004088878631591797, 0.00031453371047973633, 0.00028717517852783203, 0.0002250075340270996, 0.00029546022415161133, 0.00019502639770507812, 0.0005106925964355469, 0.0005089640617370605, 0.0004284381866455078, 0.00022482872009277344, 0.0003025531768798828, 0.00029158592224121094, 0.00021451711654663086, 0.0004011392593383789, 0.00024056434631347656, 0.00021278858184814453, 0.0006916522979736328, 0.0007354021072387695, 0.0002766251564025879, 0.0004888772964477539, 0.0005910992622375488, 0.0003490447998046875, 0.00015717744827270508, 0.0005291104316711426, 0.00028079748153686523, 0.000673830509185791, 0.0003529191017150879, 0.0002792477607727051, 0.00042933225631713867, 0.0006082057952880859, 0.00020873546600341797, 0.000510096549987793, 0.0006718635559082031, 0.00015664100646972656, 0.0006730556488037109, 0.0004591941833496094, 0.00045490264892578125, 0.0004963278770446777, 0.0003947019577026367, 0.0009081363677978516, 0.001195669174194336, 0.00041735172271728516, 0.00037360191345214844, 0.0005435347557067871, 0.0009208321571350098, 0.0006751418113708496, 0.000469207763671875, 0.0006677508354187012, 0.0013902783393859863, 0.00042748451232910156, 0.0006733536720275879, 0.0009516477584838867, 0.0005114078521728516, 0.0003622770309448242, 0.0004181861877441406, 0.00041031837463378906, 0.0009971857070922852, 0.00034439563751220703, 0.0007665157318115234, 0.0003923773765563965, 0.0005104541778564453, 0.0006195902824401855, 0.0006107091903686523, 0.0002968907356262207, 0.0008030533790588379, 0.0003408193588256836, 0.00037360191345214844, 0.0002250075340270996, 0.0005308389663696289, 0.00028204917907714844, 0.0007102489471435547, 0.00012362003326416016, 0.00026166439056396484, 0.0001780390739440918, 0.0008534789085388184, 0.0003387928009033203, 0.00022661685943603516, 0.00048416852951049805, 0.00033479928970336914, 0.00031238794326782227, 0.00016045570373535156, 0.0002465248107910156, 0.00020420551300048828, 0.000523686408996582, 0.00024271011352539062, 0.00027370452880859375, 0.00026720762252807617, 0.0007369518280029297, 0.0001837015151977539, 0.00025218725204467773, 0.00018173456192016602, 0.00032192468643188477, 0.00030732154846191406, 0.00021719932556152344, 0.00042003393173217773, 0.0004495978355407715, 0.00026172399520874023, 0.00023430585861206055, 0.0008050799369812012, 0.00041115283966064453, 0.0005688667297363281, 0.0004709959030151367, 0.00021392107009887695, 0.00033664703369140625, 0.0010187029838562012, 0.0003281235694885254, 0.00043022632598876953, 0.0003927946090698242, 0.00048345327377319336, 0.00027763843536376953, 0.00026869773864746094, 0.000664830207824707, 0.000677645206451416, 0.00040525197982788086, 0.0007132291793823242, 0.0004337430000305176, 0.00038999319076538086, 0.0008348226547241211, 0.00038427114486694336, 0.000682830810546875, 0.000507354736328125, 0.00021564960479736328, 0.0002613663673400879, 0.0004457831382751465, 0.0003660917282104492, 0.0005837082862854004, 0.0002592802047729492, 0.0009592771530151367, 0.0004673004150390625, 0.0005289316177368164, 0.0007703304290771484, 0.0005005002021789551, 0.0006964206695556641, 0.000410616397857666, 0.0007179975509643555, 0.0009279847145080566, 0.0011000633239746094, 0.0004987120628356934, 0.0004754066467285156, 0.0003972053527832031, 0.00022721290588378906, 0.00033587217330932617, 0.0003063678741455078, 0.0001863241195678711, 0.0005002617835998535, 0.00035375356674194336, 0.0004056692123413086, 0.0005593299865722656, 0.00042569637298583984, 0.00018513202667236328, 0.00034439563751220703, 0.00014317035675048828, 0.00029474496841430664, 0.0001939535140991211, 0.0003216266632080078, 0.00027257204055786133, 0.00041961669921875, 0.00023114681243896484, 0.0003364682197570801, 0.0001996755599975586, 0.00026679039001464844, 0.0002789497375488281, 0.00021469593048095703, 0.00048291683197021484, 0.0001958608627319336, 0.0008606314659118652, 0.0007194280624389648, 0.00041866302490234375, 0.0001329183578491211, 0.0003235340118408203, 0.00043517351150512695, 0.0003986954689025879, 0.0006694793701171875, 0.0002695918083190918, 0.00017386674880981445, 0.00021755695343017578, 0.0007617473602294922, 0.0004436969757080078, 0.0005660057067871094, 0.00015681982040405273, 0.0003069639205932617, 0.0004699230194091797, 0.00036072731018066406, 0.0006719827651977539, 0.0008981227874755859, 0.0007149577140808105, 0.0005891919136047363, 0.0005756616592407227, 0.0010390281677246094, 0.0005140900611877441, 0.00024271011352539062, 0.0003317594528198242, 0.00042879581451416016, 0.0008684396743774414, 0.0011014938354492188, 0.0008262991905212402, 0.0007292032241821289, 0.0012040138244628906, 0.0006340742111206055, 0.000453948974609375, 0.000363767147064209, 0.0011425614356994629, 0.0006345510482788086, 0.0002716183662414551, 0.0005164146423339844, 0.00046753883361816406, 0.0003819465637207031, 0.00030356645584106445, 0.0008309483528137207, 0.0003802776336669922, 0.000562131404876709, 0.0003846287727355957, 0.0003758072853088379, 0.0003496408462524414, 0.00031054019927978516, 0.00034940242767333984, 0.0004987716674804688, 0.00010758638381958008, 0.0005068182945251465, 0.0004850029945373535, 0.0010334253311157227, 0.0004162788391113281, 0.0005202293395996094, 0.0009118318557739258, 0.0009917020797729492, 0.00010955333709716797, 0.00023168325424194336, 0.00029921531677246094, 0.00017404556274414062, 0.0003808736801147461, 0.0001951456069946289, 0.0004963278770446777, 0.00024056434631347656, 0.0008395910263061523, 0.00018608570098876953, 0.0002969503402709961, 0.00022912025451660156, 0.0004559755325317383, 0.0003757476806640625, 0.0004630088806152344, 0.0005884766578674316, 0.00045287609100341797, 0.0006693601608276367, 0.0006061792373657227, 0.00023651123046875, 0.00023883581161499023, 0.00041997432708740234, 0.0002415776252746582, 0.0005254745483398438, 0.0004895329475402832, 0.0005379915237426758, 0.0003891587257385254, 0.00033789873123168945, 0.0004552602767944336, 0.00036263465881347656, 0.00033223628997802734, 0.00042498111724853516, 0.0002745389938354492, 0.00038367509841918945, 0.0003281831741333008, 0.0004744529724121094, 0.0002720952033996582, 0.0005998015403747559, 0.00024271011352539062, 0.0005034208297729492, 0.00014722347259521484, 0.00021666288375854492, 5.793571472167969e-05, 8.529424667358398e-05, 0.00015974044799804688, 0.0007508993148803711, 0.0003924369812011719, 0.00023984909057617188, 0.0008508563041687012, 0.0007828474044799805, 0.00014281272888183594, 0.0003141164779663086, 0.0003262758255004883, 0.00012290477752685547, 0.00016880035400390625, 0.0002142190933227539, 0.00015550851821899414, 0.0001722574234008789, 0.00020372867584228516, 0.00016385316848754883, 0.00017148256301879883, 0.0005033612251281738, 0.0002173781394958496, 0.00024175643920898438, 0.0003330707550048828, 0.00034421682357788086, 0.0008009076118469238, 0.00022214651107788086, 0.0004374384880065918, 0.0008615255355834961, 0.0002599954605102539, 0.0004924535751342773, 0.0004974007606506348, 0.000478208065032959, 0.0003617405891418457, 0.00028896331787109375, 0.00047647953033447266, 0.00030481815338134766, 0.00018352270126342773, 0.00019788742065429688, 0.00030684471130371094, 0.00023174285888671875, 0.00012123584747314453, 0.0003044605255126953, 7.873773574829102e-05, 0.00047582387924194336, 0.0001518726348876953, 0.0002963542938232422, 0.000232696533203125, 0.00022792816162109375, 0.00035643577575683594, 0.0006671547889709473, 0.00032776594161987305, 0.00027483701705932617, 0.00013405084609985352, 0.0002181529998779297, 0.00039517879486083984, 0.0003857612609863281, 0.00030171871185302734, 0.00031048059463500977, 0.000444948673248291, 8.857250213623047e-05, 0.0003095865249633789, 0.0002536773681640625, 0.000353395938873291, 0.0002950429916381836, 0.0002759099006652832, 0.00018835067749023438, 0.0003161430358886719, 0.00012767314910888672, 0.0002676844596862793, 0.00042253732681274414, 0.00046324729919433594, 0.00039780139923095703]
# uot_itr=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# uot_mmd=[100, 0.5594930052757263, 0.12841200828552246, 0.24808377027511597, 0.1859433948993683, 0.2927539348602295, 0.34065359830856323, 0.1962558478116989, 0.1272079348564148, 0.14484429359436035, 0.18937921524047852, 0.19002148509025574, 0.16756591200828552, 0.1337532103061676, 0.10092943906784058, 0.08465677499771118, 0.06973797082901001, 0.06143471598625183, 0.051901280879974365, 0.048386573791503906, 0.050067901611328125, 0.04537266492843628, 0.029083967208862305, 0.0025614500045776367, 0.007946133613586426, 0.008935213088989258, 0.012188971042633057, 0.01851874589920044, 0.007214665412902832, 0.010858416557312012, 0.0017957687377929688, 0.005589008331298828, 0.0028609037399291992, 0.007423460483551025, 0.007077634334564209, 0.006601691246032715, 0.009254813194274902, 0.002835988998413086, 0.007424354553222656, 0.0037311315536499023, 0.008807539939880371, 0.005696892738342285, 0.0027504563331604004, 0.0015557408332824707, 0.004631519317626953, 0.00035130977630615234, 0.0008456110954284668, 0.0028064846992492676, 0.002810835838317871, 0.00047272443771362305, 0.0003616809844970703, 0.002626657485961914, 0.0014573335647583008, 0.00047135353088378906, 0.0006681680679321289, 0.0023163557052612305, 0.00040775537490844727, 0.00032252073287963867, 0.0023186206817626953, 0.001025557518005371, 0.0006865859031677246, 0.0005388855934143066, 0.0018450021743774414, 0.0006576776504516602, 0.0006079673767089844, 0.0013956427574157715, 0.0003108978271484375, 0.00025075674057006836, 0.0012046098709106445, 0.0002263784408569336, 0.00016939640045166016, 0.0003217458724975586, 0.001986861228942871, 0.0012401342391967773, 0.00037604570388793945, 0.00032782554626464844, 0.0012025833129882812, 0.0013532638549804688, 0.0007367730140686035, 0.0006958246231079102, 0.0007383227348327637, 0.0004725456237792969, 0.0006450414657592773, 0.0004761815071105957, 0.0009735226631164551, 0.0008946657180786133, 0.0010750293731689453, 0.0007334351539611816, 0.0006592273712158203, 0.0010129213333129883, 0.0008672475814819336, 0.0008058547973632812, 0.0010373592376708984, 0.0007293820381164551, 0.001284778118133545, 0.0012829303741455078, 0.0004470944404602051, 0.0003375411033630371, 0.0006336569786071777, 0.0003361701965332031, 0.0013992786407470703, 0.00013244152069091797, 0.0007363557815551758, 0.0006396770477294922, 0.0012232065200805664, 0.0011616945266723633, 0.002341151237487793, 0.001275181770324707, 0.0009379982948303223, 0.0005290508270263672, 0.0009257197380065918, 0.0005162954330444336, 0.0006196498870849609, 0.0005940794944763184, 0.0012382268905639648, 0.0013074278831481934, 0.0010766386985778809, 0.0002682805061340332, 0.0009324550628662109, 0.0006311535835266113, 0.0008590221405029297, 0.00046509504318237305, 0.00015437602996826172, 0.000606834888458252, 0.0010405182838439941, 0.0010100603103637695, 0.0015823841094970703, 0.000797271728515625, 0.00037914514541625977, 0.0015059709548950195, 0.0009198188781738281, 0.00031125545501708984, 0.0006524324417114258, 0.0007367134094238281, 0.0008337497711181641, 0.0004813671112060547, 0.0012180805206298828, 0.001076817512512207, 0.000571131706237793, 0.0007715821266174316, 0.0006629824638366699, 0.0012891888618469238, 0.0012197494506835938, 0.0016540884971618652, 0.0018589496612548828, 0.0006303787231445312, 0.00018256902694702148, 0.0006464719772338867, 0.0006077885627746582, 0.0012547969818115234, 0.001210927963256836, 0.001870274543762207, 0.0017838478088378906, 0.000980675220489502, 0.0007295608520507812, 0.0007283687591552734, 0.0005064010620117188, 0.0012347698211669922, 0.0008548498153686523, 0.0016754865646362305, 0.0017032623291015625, 0.00017917156219482422, 0.0016362667083740234, 0.0011345148086547852, 0.0005902647972106934, 0.0014110207557678223, 0.0007902383804321289, 0.0011136531829833984, 0.00044035911560058594, 0.0009222030639648438, 0.0011187195777893066, 0.001033186912536621, 0.0019237995147705078, 0.0006755590438842773, 0.0003345012664794922, 0.0007697343826293945, 0.00045108795166015625, 0.0011562108993530273, 0.0007863044738769531, 0.001849353313446045, 0.0010089278221130371, 0.001080632209777832, 0.0010672807693481445, 0.0004982948303222656, 0.0007495880126953125, 0.0006354451179504395, 0.0008777379989624023, 0.0011445283889770508, 0.0008227825164794922, 0.0004068613052368164, 0.00043517351150512695, 0.0010715723037719727, 0.0005571246147155762, 0.0004901885986328125, 0.0013570189476013184, 0.001084446907043457, 0.0005949735641479492, 0.0005782246589660645, 0.00024050474166870117, 0.0005581974983215332, 0.0003389120101928711, 0.0006536245346069336, 0.0003243088722229004, 0.0005505084991455078, 0.00016999244689941406, 0.00020396709442138672, 0.0002321004867553711, 7.593631744384766e-05, 0.00038230419158935547, 0.00016427040100097656, 0.0005246400833129883, 0.00014340877532958984, 0.0004904270172119141, 0.000647127628326416, 0.0005258917808532715, 0.0001844167709350586, 0.0002446174621582031, 0.0004360079765319824, 0.0003129243850708008, 0.0003058910369873047, 0.00017952919006347656, 0.00029659271240234375, 0.00034749507904052734, 0.00032508373260498047, 0.0005211830139160156, 0.000540614128112793, 0.0010033845901489258, 0.0009608864784240723, 0.0003688335418701172, 0.0006211996078491211, 0.0010302066802978516, 0.0007971525192260742, 0.0008667707443237305, 0.00013297796249389648, 0.0003113746643066406, 0.000446319580078125, 0.0004757046699523926, 0.0007991790771484375, 0.0006846189498901367, 0.0012803077697753906, 0.0012034773826599121, 0.0006299614906311035, 0.0006036162376403809, 0.00030881166458129883, 0.00032788515090942383, 0.0010058879852294922, 0.00031006336212158203, 0.0006117820739746094, 0.0003718137741088867, 0.0006093382835388184, 0.0002639293670654297, 0.001410067081451416, 0.0009562969207763672, 0.0006653666496276855, 0.001305699348449707, 0.0011240839958190918, 0.000535428524017334, 0.0008802413940429688, 0.0005116462707519531, 0.0004018545150756836, 0.00030541419982910156, 0.0005667209625244141, 0.0003927946090698242, 0.0009737014770507812, 0.0006170868873596191, 0.0004546642303466797, 0.00043147802352905273, 0.00024271011352539062, 0.000606536865234375, 0.0003013014793395996, 0.0003711581230163574, 0.0007107853889465332, 0.00047326087951660156, 0.0008542537689208984, 0.000765681266784668, 0.0005090236663818359, 0.0012547969818115234, 0.00023031234741210938, 0.0003337860107421875, 0.0004391670227050781, 0.0008710026741027832, 0.000644981861114502, 0.00017213821411132812, 0.0005031824111938477, 0.0009409189224243164, 0.0002753734588623047, 0.0003483891487121582, 0.00023978948593139648, 0.0002359151840209961, 0.00118255615234375, 0.0005345940589904785, 0.0006996393203735352, 0.0001838207244873047, 0.0006539225578308105, 0.0003026127815246582, 0.0002543926239013672, 0.0004360675811767578, 0.00024890899658203125, 0.0004699230194091797, 0.0010062456130981445, 0.00022852420806884766, 0.0003324747085571289, 0.00043582916259765625, 0.0005524158477783203, 0.0005891323089599609, 0.00011169910430908203, 0.00032895803451538086, 0.0003018379211425781, 0.0002645254135131836, 0.00044983625411987305, 0.0006531476974487305, 0.0006577372550964355, 0.00034224987030029297, 0.0005932450294494629, 0.00016623735427856445, 0.0005260109901428223, 0.00041025876998901367, 0.0004023909568786621, 0.0005217790603637695, 0.0004107952117919922, 0.0005230903625488281, 0.0002383589744567871, 0.0001259446144104004, 0.00028645992279052734, 0.0002689361572265625, 0.00030428171157836914, 0.0002650618553161621, 0.000683903694152832, 0.0003857612609863281, 0.0002751350402832031, 0.00022608041763305664, 0.0005881190299987793, 0.0007452964782714844, 0.00041991472244262695, 0.001763463020324707, 0.00032782554626464844, 0.00019437074661254883, 0.00041025876998901367, 0.000842750072479248, 0.0003082752227783203, 0.0003796219825744629, 0.0005339980125427246, 0.0004760622978210449, 0.0002168416976928711, 0.00042051076889038086, 0.0006873607635498047, 0.00044524669647216797, 0.0007137060165405273, 0.00043582916259765625, 0.00023955106735229492, 0.0005895495414733887, 0.00018930435180664062, 0.0002167224884033203, 0.00010007619857788086, 0.0008940696716308594, 0.001280069351196289, 0.0011813640594482422, 0.0005469322204589844, 0.0007287263870239258, 0.0007200241088867188, 0.00045490264892578125, 0.00035572052001953125, 0.0004118680953979492, 0.000655055046081543, 0.0004134178161621094, 0.00022149085998535156, 0.000518798828125, 0.0009715557098388672, 0.0005029439926147461, 0.0006248950958251953, 0.0005692839622497559, 0.00042068958282470703, 0.0007767677307128906, 0.00027817487716674805, 0.0002332925796508789, 0.00025784969329833984, 0.0003129243850708008, 0.00044018030166625977, 0.00018513202667236328, 0.00042498111724853516, 0.00022554397583007812, 0.00031745433807373047, 0.000645756721496582, 0.00021070241928100586, 0.0005418062210083008, 0.0003657341003417969, 0.000377655029296875, 0.00025451183319091797, 0.0001354217529296875, 0.00012201070785522461, 9.465217590332031e-05, 0.00021445751190185547, 0.0002358555793762207, 0.00016564130783081055, 0.00014853477478027344, 0.00025713443756103516, 0.0002694129943847656, 5.072355270385742e-05, 0.0002582073211669922, 0.00028580427169799805, 0.0009807944297790527, 0.0009554624557495117, 0.0013058185577392578, 0.0010604262351989746, 0.002353489398956299, 0.0017992258071899414, 0.0028247833251953125, 0.002541184425354004, 0.0032785534858703613, 0.0020838379859924316, 0.0026695728302001953, 0.003244161605834961, 0.0013557076454162598, 0.0020381808280944824, 0.0007673501968383789, 0.0010334253311157227, 0.0013495683670043945, 0.0015375614166259766, 0.0018742680549621582, 0.0023769140243530273, 0.0015006065368652344, 0.001130223274230957, 0.0012379884719848633, 0.0009607672691345215, 0.0010895133018493652, 0.0010917186737060547, 0.0010977387428283691, 0.0008398294448852539, 0.0005730390548706055, 0.00018829107284545898, 0.0001442432403564453, 0.0009198784828186035, 0.0005037784576416016, 0.00042694807052612305, 0.0006646513938903809, 0.00014609098434448242, 0.0005671381950378418, 0.00030177831649780273, 0.0006787776947021484, 0.0008094906806945801, 0.0006345510482788086, 0.0009633898735046387, 0.000899195671081543, 0.00033843517303466797, 0.0005211830139160156, 0.00041961669921875, 0.00011521577835083008, 0.0005415081977844238, 0.00039970874786376953, 0.00029599666595458984, 0.00020486116409301758, 0.0007236599922180176, 0.0006161928176879883, 8.726119995117188e-05, 0.0003438591957092285, 0.0010445117950439453, 0.0009453296661376953, 0.00031375885009765625, 0.0002777576446533203, 0.00026530027389526367, 0.0003540515899658203, 0.00033718347549438477, 0.000821232795715332, 0.00015985965728759766, 0.00026851892471313477, 0.00029838085174560547, 0.00013315677642822266, 0.0006234049797058105, 0.0001741647720336914, 0.0007696747779846191, 0.00045377016067504883, 0.00041174888610839844, 0.00044727325439453125, 0.0004388093948364258, 0.0001735687255859375, 0.00023221969604492188, 0.00021219253540039062, 0.00024706125259399414, 0.001099705696105957, 0.0007520914077758789, 0.00023180246353149414, 0.00047957897186279297, 0.0006178617477416992, 0.0004659891128540039, 0.0007780790328979492, 0.00037807226181030273, 0.0002887845039367676, 0.000286102294921875, 0.0006234049797058105, 0.00033485889434814453, 0.0006647706031799316, 0.0005965232849121094, 0.0001920461654663086, 0.0003001689910888672, 0.000784754753112793, 0.00036215782165527344, 0.0004246234893798828, 0.0007891654968261719, 0.000997304916381836, 0.0005757808685302734]
#
# t = 150
# plt.plot(ot_itr[t:], ot_mmd[t:], label="OT")
# plt.plot(uot_itr[t:], uot_mmd[t:], label="UOT")
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.title('Trainging samples:{}, Test samples:{}'.format(4096,4096))
# plt.legend()
# plt.show()
#
# # 4096 train, 20 test MMD
# ot_itr=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# ot_mmd=[0.4415212869644165, 0.5060415267944336, 0.15379831194877625, 0.4913265109062195, 0.1438969075679779, 0.25805437564849854, 0.3130415081977844, 0.22687260806560516, 0.19483467936515808, 0.2700275182723999, 0.32072943449020386, 0.2931255102157593, 0.17014873027801514, 0.11946821212768555, 0.18532422184944153, 0.0665917694568634, 0.16563013195991516, 0.14605224132537842, 0.07225129008293152, 0.10657644271850586, 0.06715381145477295, 0.06918370723724365, 0.07844698429107666, 0.03447580337524414, 0.06984609365463257, 0.02570486068725586, 0.06910401582717896, 0.058321237564086914, 0.06931817531585693, 0.08157515525817871, 0.09114354848861694, 0.10412043333053589, 0.04120218753814697, 0.07020783424377441, 0.07300496101379395, 0.025097906589508057, 0.01142197847366333, 0.013065993785858154, 0.07934308052062988, 0.06862714886665344, 0.03998363018035889, 0.005391478538513184, 0.0057375431060791016, 0.014341115951538086, 0.018808484077453613, 0.04795730113983154, 0.05583280324935913, 0.06803238391876221, 0.017710745334625244, 0.024986684322357178, 0.017497360706329346, 0.050351858139038086, 0.010881125926971436, 0.020129501819610596, 0.009532392024993896, 0.010523557662963867, 0.01082146167755127, 0.055374324321746826, 0.0444222092628479, 0.05533730983734131, 0.022575020790100098, 0.012432515621185303, 0.03539156913757324, 0.015068888664245605, 0.032111406326293945, 0.025926053524017334, 0.009553074836730957, 0.03206580877304077, 0.022527754306793213, 0.0226517915725708, 0.025390207767486572, 0.04653352499008179, 0.032788753509521484, 0.012396633625030518, 0.06209772825241089, 0.009695470333099365, 0.028839290142059326, 0.046481430530548096, 0.0232122540473938, 0.02703148126602173, 0.02006632089614868, 0.023794114589691162, 0.04028445482254028, 0.014696061611175537, 0.03741735219955444, 0.014209628105163574, 0.03327381610870361, 0.04177689552307129, 0.05676025152206421, 0.020696699619293213, 0.03861945867538452, 0.006070196628570557, 0.034739673137664795, 0.026594817638397217, 0.012223899364471436, 0.019548475742340088, 0.03844904899597168, 0.04570847749710083, 0.05263781547546387, 0.02873176336288452, 0.035892367362976074, 0.042149364948272705, 0.026195049285888672, 0.039612412452697754, 0.030359625816345215, 0.009544968605041504, 0.048925697803497314, 0.10342931747436523, 0.056347668170928955, 0.03340506553649902, 0.030334413051605225, 0.04627645015716553, 0.027927756309509277, 0.030007600784301758, 0.05331999063491821, 0.034934043884277344, 0.08971410989761353, 0.0696139931678772, 0.028295040130615234, 0.017988622188568115, 0.04914134740829468, 0.0796768069267273, 0.04617118835449219, 0.007923245429992676, 0.03542381525039673, 0.0667838454246521, 0.01639765501022339, 0.01640760898590088, 0.009113013744354248, 0.026997745037078857, 0.022257745265960693, 0.07006853818893433, 0.027413487434387207, 0.03624945878982544, 0.033135175704956055, 0.06642955541610718, 0.09547168016433716, 0.017941951751708984, 0.03208738565444946, 0.01632004976272583, 0.01573348045349121, 0.0029549002647399902, 0.031808435916900635, 0.04029190540313721, 0.04289311170578003, 0.02770155668258667, 0.025319695472717285, 0.008339941501617432, 0.09229022264480591, 0.044714391231536865, 0.008522987365722656, 0.01784360408782959, 0.03777045011520386, 0.014609217643737793, 0.008535504341125488, 0.010737180709838867, 0.026888489723205566, 0.01989525556564331, 0.030088841915130615, 0.13165217638015747, 0.01979142427444458, 0.0559849739074707, 0.043907999992370605, 0.029030680656433105, 0.024870455265045166, 0.005119144916534424, 0.047803521156311035, 0.08302450180053711, 0.024854063987731934, 0.03708839416503906, 0.023531854152679443, 0.05080181360244751, 0.012263655662536621, 0.0566105842590332, 0.012466728687286377, 0.05053389072418213, 0.017224788665771484, 0.00749814510345459, 0.03096085786819458, 0.05752497911453247, 0.0342063307762146, 0.06471580266952515, 0.08059990406036377, 0.009108662605285645, 0.06355148553848267, 0.018671751022338867, 0.031411051750183105, 0.029158055782318115, 0.014228403568267822, 0.056232988834381104, 0.02036339044570923, 0.005048394203186035, 0.037574052810668945, 0.025812208652496338, 0.05519461631774902, 0.09103983640670776, 0.018493950366973877, 0.028046071529388428, 0.026884913444519043, 0.044245898723602295, 0.02906978130340576, 0.013266503810882568, 0.017696022987365723, 0.04315239191055298, 0.01881939172744751, 0.030172109603881836, 0.06162673234939575, 0.01006162166595459, 0.012199163436889648, 0.021820247173309326, 0.008861780166625977, 0.07385194301605225, 0.12826019525527954, 0.061808377504348755, 0.04490983486175537, 0.016926229000091553, 0.0264623761177063, 0.08122372627258301, 0.01130586862564087, 0.026580452919006348, 0.08486419916152954, 0.05276334285736084, 0.014829754829406738, 0.05757516622543335, 0.03838306665420532, 0.03431981801986694, 0.03676027059555054, 0.011871159076690674, 0.03267258405685425, 0.019908428192138672, 0.028404414653778076, 0.03467375040054321, 0.03180485963821411, 0.028752267360687256, 0.01717931032180786, 0.02943176031112671, 0.02511698007583618, 0.04118400812149048, 0.00463557243347168, 0.1062999963760376, 0.05061650276184082, 0.021232545375823975, 0.04242914915084839, 0.07101988792419434, 0.0522024929523468, 0.008388936519622803, 0.041222572326660156, 0.07971054315567017, 0.008788824081420898, 0.019048750400543213, 0.018202543258666992, 0.062469303607940674, 0.06796044111251831, 0.02781730890274048, 0.022600650787353516, 0.03169363737106323, 0.04493743181228638, 0.00925743579864502, 0.0071637630462646484, 0.05116325616836548, 0.010820865631103516, 0.06447768211364746, 0.0172346830368042, 0.021117210388183594, 0.019778788089752197, 0.062271714210510254, 0.018040716648101807, 0.10437697172164917, 0.01978886127471924, 0.019734501838684082, 0.07085442543029785, 0.08341854810714722, 0.04997730255126953, 0.008215069770812988, 0.01451486349105835, 0.02312004566192627, 0.027036964893341064, 0.03627902269363403, 0.02175527811050415, 0.028421521186828613, 0.03201192617416382, 0.036945223808288574, 0.018518149852752686, 0.05665785074234009, 0.012683510780334473, 0.029692471027374268, 0.03232985734939575, 0.01914083957672119, 0.05134302377700806, 0.006902575492858887, 0.19966787099838257, 0.07022279500961304, 0.026855111122131348, 0.009016633033752441, 0.027842581272125244, 0.021419167518615723, 0.008337676525115967, 0.051741838455200195, 0.021825194358825684, 0.03343290090560913, 0.0343167781829834, 0.029652893543243408, 0.03020799160003662, 0.050888776779174805, 0.014478743076324463, 0.020521044731140137, 0.019199669361114502, 0.03992217779159546, 0.025130033493041992, 0.04284757375717163, 0.03999817371368408, 0.027386069297790527, 0.06654572486877441, 0.06387490034103394, 0.07599836587905884, 0.021692097187042236, 0.006117880344390869, 0.027730345726013184, 0.020588159561157227, 0.02149897813796997, 0.026708245277404785, 0.011417508125305176, 0.01911342144012451, 0.03514021635055542, 0.04365354776382446, 0.015307128429412842, 0.027294456958770752, 0.028613567352294922, 0.06103914976119995, 0.08678364753723145, 0.01764535903930664, 0.03168010711669922, 0.02407127618789673, 0.019438087940216064, 0.06606501340866089, 0.05400562286376953, 0.007455766201019287, 0.03214484453201294, 0.023524701595306396, 0.06123983860015869, 0.1352253556251526, 0.04159724712371826, 0.05085855722427368, 0.060177385807037354, 0.1036074161529541, 0.02583557367324829, 0.06605696678161621, 0.04636329412460327, 0.023819327354431152, 0.038762569427490234, 0.022929072380065918, 0.017242789268493652, 0.022743940353393555, 0.02675849199295044, 0.05096811056137085, 0.021709144115447998, 0.07814866304397583, 0.039196550846099854, 0.029768049716949463, 0.028976619243621826, 0.05592268705368042, 0.015684902667999268, 0.010519206523895264, 0.01074129343032837, 0.026801645755767822, 0.03141099214553833, 0.01431196928024292, 0.07698744535446167, 0.022458970546722412, 0.023928523063659668, 0.010927259922027588, 0.03442877531051636, 0.07188278436660767, 0.04444211721420288, 0.038000404834747314, 0.029073119163513184, 0.04280054569244385, 0.05674213171005249, 0.008857369422912598, 0.026930809020996094, 0.03787970542907715, 0.024780690670013428, 0.01293325424194336, 0.05425220727920532, 0.022430896759033203, 0.018458425998687744, 0.03655874729156494, 0.06960612535476685, 0.019782841205596924, 0.031205594539642334, 0.0695447325706482, 0.02816927433013916, 0.010314524173736572, 0.06623184680938721, 0.06545883417129517, 0.06557875871658325, 0.029218852519989014, 0.006308376789093018, 0.02392113208770752, 0.022047221660614014, 0.03499859571456909, 0.03209489583969116, 0.011882603168487549, 0.02351689338684082, 0.011967301368713379, 0.034559041261672974, 0.036181509494781494, 0.033974289894104004, 0.008712053298950195, 0.028171300888061523, 0.011018097400665283, 0.04498946666717529, 0.006907522678375244, 0.014783918857574463, 0.03921705484390259, 0.059753358364105225, 0.09990549087524414, 0.026932835578918457, 0.067574143409729, 0.032398998737335205, 0.014259397983551025, 0.024267375469207764, 0.05114853382110596, 0.008640170097351074, 0.04359942674636841, 0.012224256992340088, 0.016105592250823975, 0.03326725959777832, 0.051320672035217285, 0.02330493927001953, 0.04884821176528931, 0.03674018383026123, 0.028605341911315918, 0.05854290723800659, 0.01178276538848877, 0.0209009051322937, 0.058450788259506226, 0.05581951141357422, 0.051421284675598145, 0.017635703086853027, 0.007564246654510498, 0.046594321727752686, 0.05596435070037842, 0.04666644334793091, 0.022847294807434082, 0.021603882312774658, 0.03657686710357666, 0.02775704860687256, 0.03090083599090576, 0.022471308708190918, 0.04960143566131592, 0.04863166809082031, 0.007583558559417725, 0.03853088617324829, 0.04369044303894043, 0.018112778663635254, 0.07011467218399048, 0.0244637131690979, 0.016104578971862793, 0.05438077449798584, 0.045216381549835205, 0.032010674476623535, 0.014812350273132324, 0.07570630311965942, 0.016323864459991455, 0.03165680170059204, 0.01970142126083374, 0.05301070213317871, 0.012195765972137451, 0.07435011863708496, 0.045848727226257324, 0.028987646102905273, 0.05586951971054077, 0.027394354343414307, 0.06092745065689087, 0.006211817264556885, 0.015287637710571289, 0.0350346565246582, 0.018114328384399414, 0.16205376386642456, 0.017284929752349854, 0.022193491458892822, 0.03298550844192505, 0.013888716697692871, 0.03357434272766113, 0.020875155925750732, 0.0711439847946167, 0.04861712455749512, 0.016922354698181152, 0.021839499473571777, 0.008159041404724121, 0.033620595932006836, 0.0469975471496582, 0.03261834383010864, 0.024267613887786865, 0.01963120698928833, 0.04951256513595581, 0.043625593185424805, 0.05228322744369507, 0.08087056875228882]
#
# uot_itr=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# uot_mmd=[100, 0.9251745939254761, 0.3743535280227661, 0.2092844843864441, 0.3570786714553833, 0.2948915362358093, 0.3958631753921509, 0.6544080376625061, 0.24430054426193237, 0.2602289915084839, 0.30584555864334106, 0.20450526475906372, 0.3008989989757538, 0.17927652597427368, 0.13835930824279785, 0.3155086636543274, 0.10938137769699097, 0.11292678117752075, 0.09053152799606323, 0.09623146057128906, 0.04935950040817261, 0.11148697137832642, 0.14551442861557007, 0.1973510980606079, 0.062207311391830444, 0.0836935043334961, 0.12583869695663452, 0.04353323578834534, 0.036501288414001465, 0.08627551794052124, 0.08901125192642212, 0.03027474880218506, 0.023613035678863525, 0.022104501724243164, 0.047909677028656006, 0.030341804027557373, 0.012890398502349854, 0.05255401134490967, 0.018993020057678223, 0.026194214820861816, 0.034107327461242676, 0.0225943922996521, 0.004985928535461426, 0.031479477882385254, 0.05060875415802002, 0.12461930513381958, 0.023140013217926025, 0.09826982021331787, 0.030883193016052246, 0.011719465255737305, 0.024474263191223145, 0.040266573429107666, 0.038973093032836914, 0.028409123420715332, 0.041120290756225586, 0.006080031394958496, 0.03258758783340454, 0.033522844314575195, 0.022515594959259033, 0.02631455659866333, 0.03711557388305664, 0.017658770084381104, 0.030567944049835205, 0.02084207534790039, 0.014044523239135742, 0.043316781520843506, 0.0205041766166687, 0.017261028289794922, 0.022851228713989258, 0.004323720932006836, 0.07980364561080933, 0.03430283069610596, 0.023431777954101562, 0.04071688652038574, 0.06360507011413574, 0.03342282772064209, 0.03292739391326904, 0.05622982978820801, 0.01507657766342163, 0.015539824962615967, 0.02733546495437622, 0.02111077308654785, 0.01523125171661377, 0.08407515287399292, 0.0269891619682312, 0.02039158344268799, 0.03298497200012207, 0.025106310844421387, 0.02751868963241577, 0.03190797567367554, 0.056308746337890625, 0.018580377101898193, 0.09468090534210205, 0.02913820743560791, 0.08001053333282471, 0.01793903112411499, 0.027318298816680908, 0.04688429832458496, 0.034032464027404785, 0.04995542764663696, 0.08239644765853882, 0.09925192594528198, 0.021984219551086426, 0.026927709579467773, 0.020647943019866943, 0.0315476655960083, 0.013669133186340332, 0.04769718647003174, 0.046534836292266846, 0.01805657148361206, 0.038012564182281494, 0.0698627233505249, 0.058795928955078125, 0.007346987724304199, 0.030385076999664307, 0.10909557342529297, 0.005449175834655762, 0.04706776142120361, 0.021753430366516113, 0.03399014472961426, 0.03783756494522095, 0.022310733795166016, 0.03204751014709473, 0.014907300472259521, 0.09231221675872803, 0.006664156913757324, 0.020444035530090332, 0.07089197635650635, 0.014866292476654053, 0.0531846284866333, 0.028127968311309814, 0.05212116241455078, 0.14546966552734375, 0.04294407367706299, 0.06779301166534424, 0.0757022500038147, 0.02923893928527832, 0.045581817626953125, 0.030590295791625977, 0.040369391441345215, 0.023923158645629883, 0.0743485689163208, 0.055303871631622314, 0.013484060764312744, 0.014510393142700195, 0.08532136678695679, 0.154266357421875, 0.029712200164794922, 0.008336246013641357, 0.014655351638793945, 0.03273463249206543, 0.03813964128494263, 0.042490243911743164, 0.022008776664733887, 0.017961084842681885, 0.046018123626708984, 0.020769178867340088, 0.020671069622039795, 0.03166157007217407, 0.03771185874938965, 0.009861111640930176, 0.016102373600006104, 0.020366430282592773, 0.017816126346588135, 0.007464885711669922, 0.03751814365386963, 0.031380295753479004, 0.035942792892456055, 0.025362372398376465, 0.011935114860534668, 0.09249293804168701, 0.040287137031555176, 0.02747964859008789, 0.032367587089538574, 0.016536712646484375, 0.03746718168258667, 0.018244802951812744, 0.013174116611480713, 0.017629623413085938, 0.03354460000991821, 0.0326310396194458, 0.008518338203430176, 0.12996917963027954, 0.020988166332244873, 0.029501795768737793, 0.044707655906677246, 0.056923747062683105, 0.09173732995986938, 0.040804147720336914, 0.05299782752990723, 0.09195202589035034, 0.008862018585205078, 0.03163355588912964, 0.05733132362365723, 0.03933453559875488, 0.01831364631652832, 0.008101820945739746, 0.01670318841934204, 0.04750955104827881, 0.01649928092956543, 0.039357900619506836, 0.05932056903839111, 0.03703498840332031, 0.007765412330627441, 0.15093469619750977, 0.0069838762283325195, 0.05397439002990723, 0.03166675567626953, 0.06654560565948486, 0.008641600608825684, 0.015696167945861816, 0.01882702112197876, 0.02983081340789795, 0.023406386375427246, 0.023098111152648926, 0.027560770511627197, 0.04632598161697388, 0.060257911682128906, 0.030132830142974854, 0.03952556848526001, 0.03216421604156494, 0.022497475147247314, 0.06628686189651489, 0.0292588472366333, 0.05810445547103882, 0.08106005191802979, 0.026724934577941895, 0.01539754867553711, 0.03593254089355469, 0.00603252649307251, 0.02140522003173828, 0.02431410551071167, 0.030302464962005615, 0.01209414005279541, 0.052858054637908936, 0.026160717010498047, 0.03565382957458496, 0.05172288417816162, 0.026761293411254883, 0.05917465686798096, 0.04651641845703125, 0.12329989671707153, 0.032010793685913086, 0.039752840995788574, 0.054934024810791016, 0.017590761184692383, 0.012520909309387207, 0.02199840545654297, 0.08595693111419678, 0.08649325370788574, 0.017185568809509277, 0.03961491584777832, 0.032730162143707275, 0.030082225799560547, 0.06521081924438477, 0.0161592960357666, 0.011440277099609375, 0.01683706045150757, 0.02459818124771118, 0.01765894889831543, 0.06772708892822266, 0.04478001594543457, 0.021054983139038086, 0.01669222116470337, 0.052466750144958496, 0.05107748508453369, 0.06424015760421753, 0.0166168212890625, 0.014372527599334717, 0.019632279872894287, 0.0278623104095459, 0.11381065845489502, 0.020171821117401123, 0.03912407159805298, 0.03519284725189209, 0.036579251289367676, 0.05751359462738037, 0.1263105273246765, 0.02050614356994629, 0.06059533357620239, 0.03293633460998535, 0.024833858013153076, 0.017167866230010986, 0.03238356113433838, 0.07512593269348145, 0.033512115478515625, 0.0545201301574707, 0.03046584129333496, 0.016497373580932617, 0.04507189989089966, 0.007034361362457275, 0.02294325828552246, 0.030883073806762695, 0.03177887201309204, 0.05302417278289795, 0.030602693557739258, 0.027839362621307373, 0.019259929656982422, 0.054615795612335205, 0.004203915596008301, 0.01731020212173462, 0.08093971014022827, 0.04530972242355347, 0.07101774215698242, 0.03647756576538086, 0.10901641845703125, 0.046566545963287354, 0.005081117153167725, 0.06629118323326111, 0.03403210639953613, 0.013995230197906494, 0.02806556224822998, 0.14864081144332886, 0.018277883529663086, 0.019854724407196045, 0.03729081153869629, 0.016451716423034668, 0.014582216739654541, 0.06946063041687012, 0.03889232873916626, 0.04089778661727905, 0.055446505546569824, 0.010470747947692871, 0.0063855648040771484, 0.0843539834022522, 0.015145540237426758, 0.05627584457397461, 0.037024617195129395, 0.015022754669189453, 0.07048577070236206, 0.04621165990829468, 0.018434584140777588, 0.03236520290374756, 0.022515475749969482, 0.029177725315093994, 0.03193473815917969, 0.019671082496643066, 0.05559492111206055, 0.01414424180984497, 0.02440321445465088, 0.054257214069366455, 0.04480421543121338, 0.029603660106658936, 0.02337324619293213, 0.05493128299713135, 0.03213149309158325, 0.04999589920043945, 0.036252379417419434, 0.04285562038421631, 0.03780406713485718, 0.016271591186523438, 0.0244942307472229, 0.06907087564468384, 0.03451216220855713, 0.06327176094055176, 0.042356014251708984, 0.03691589832305908, 0.016083359718322754, 0.032926082611083984, 0.01957768201828003, 0.06130385398864746, 0.014539003372192383, 0.02878391742706299, 0.10799658298492432, 0.09836173057556152, 0.02748250961303711, 0.027044057846069336, 0.045932650566101074, 0.046251654624938965, 0.01714026927947998, 0.07416993379592896, 0.0277101993560791, 0.07507622241973877, 0.06750309467315674, 0.01331794261932373, 0.05155372619628906, 0.03623393177986145, 0.02974933385848999, 0.06480288505554199, 0.014298796653747559, 0.029132604598999023, 0.012874484062194824, 0.07917559146881104, 0.0264357328414917, 0.017215371131896973, 0.06277942657470703, 0.010328412055969238, 0.07930862903594971, 0.03076869249343872, 0.06923156976699829, 0.02328193187713623, 0.03172224760055542, 0.0765267014503479, 0.01349407434463501, 0.036092162132263184, 0.016347527503967285, 0.03631061315536499, 0.012007594108581543, 0.012353301048278809, 0.01912689208984375, 0.017080247402191162, 0.0446857213973999, 0.1242150068283081, 0.15071898698806763, 0.04602569341659546, 0.06694179773330688, 0.012658536434173584, 0.007664203643798828, 0.025612592697143555, 0.025549888610839844, 0.008371949195861816, 0.01227414608001709, 0.008967101573944092, 0.049491703510284424, 0.04628220200538635, 0.04257005453109741, 0.08822715282440186, 0.062471628189086914, 0.023533761501312256, 0.03835737705230713, 0.014357566833496094, 0.039881736040115356, 0.08432328701019287, 0.055107951164245605, 0.022624194622039795, 0.054126739501953125, 0.05855041742324829, 0.016802847385406494, 0.012017369270324707, 0.007678985595703125, 0.03853029012680054, 0.016037583351135254, 0.025562703609466553, 0.02741825580596924, 0.010804891586303711, 0.08340573310852051, 0.03253042697906494, 0.10078513622283936, 0.0640605092048645, 0.05819672346115112, 0.05477917194366455, 0.03147149085998535, 0.03803509473800659, 0.005238056182861328, 0.026914238929748535, 0.03764677047729492, 0.05365586280822754, 0.04097336530685425, 0.01873338222503662, 0.048161327838897705, 0.06925326585769653, 0.01944369077682495, 0.0285910964012146, 0.030097901821136475, 0.15967750549316406, 0.08723914623260498, 0.019345760345458984, 0.0247039794921875, 0.029241621494293213, 0.009935915470123291, 0.034070372581481934, 0.03315514326095581, 0.026184916496276855, 0.02915477752685547, 0.029190421104431152, 0.0267181396484375, 0.06470000743865967, 0.03278839588165283, 0.025207817554473877, 0.028875648975372314, 0.030425608158111572, 0.05166804790496826, 0.0318874716758728, 0.03900647163391113, 0.04882252216339111, 0.0025017857551574707, 0.05300343036651611, 0.055562734603881836, 0.074207603931427, 0.017593324184417725, 0.07300466299057007, 0.006928205490112305, 0.059513092041015625, 0.017872333526611328, 0.03922164440155029, 0.07549381256103516, 0.07783597707748413, 0.03391796350479126, 0.01696944236755371, 0.11509114503860474, 0.01161801815032959, 0.04836827516555786, 0.03268027305603027, 0.027840793132781982, 0.05325537919998169, 0.024329423904418945, 0.035863280296325684, 0.1043747067451477, 0.11416703462600708, 0.05583834648132324]
#
# t = 20
# plt.plot(ot_itr[t:], ot_mmd[t:], label="OT")
# plt.plot(uot_itr[t:], uot_mmd[t:], label="UOT")
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.title('Trainging samples:{}, Test samples:{}'.format(4096,20))
# plt.legend()
# plt.show()
#
#
#
# # 128 train, 20 test MMD
#
# ot_itr=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# ot_mmd=[0.41649454832077026, 0.27446094155311584, 0.4108588397502899, 0.2887176275253296, 0.09432107210159302, 0.26890552043914795, 0.1440596878528595, 0.2300441563129425, 0.15367943048477173, 0.08592498302459717, 0.19380858540534973, 0.22545084357261658, 0.18157148361206055, 0.09155675768852234, 0.11346092820167542, 0.05948188900947571, 0.11556831002235413, 0.10318759083747864, 0.13452130556106567, 0.06059229373931885, 0.09946262836456299, 0.015246748924255371, 0.07350969314575195, 0.017139732837677002, 0.12053251266479492, 0.02378559112548828, 0.06789129972457886, 0.03806257247924805, 0.06192272901535034, 0.05955016613006592, 0.026566922664642334, 0.04937106370925903, 0.029332339763641357, 0.03551316261291504, 0.05287247896194458, 0.030936717987060547, 0.03281736373901367, 0.04220163822174072, 0.04210042953491211, 0.09500861167907715, 0.06933516263961792, 0.029930055141448975, 0.04773038625717163, 0.010380208492279053, 0.08511513471603394, 0.021049320697784424, 0.03395289182662964, 0.11597687005996704, 0.047448813915252686, 0.07654988765716553, 0.0885840654373169, 0.12570488452911377, 0.05561250448226929, 0.039215803146362305, 0.05484497547149658, 0.030248284339904785, 0.03706318140029907, 0.04322528839111328, 0.037869811058044434, 0.03169804811477661, 0.023860931396484375, 0.01966679096221924, 0.03774458169937134, 0.023373663425445557, 0.19126057624816895, 0.012730538845062256, 0.04783332347869873, 0.04173988103866577, 0.024527907371520996, 0.05542415380477905, 0.028930485248565674, 0.028862476348876953, 0.06279480457305908, 0.006943643093109131, 0.04853546619415283, 0.11499255895614624, 0.014860808849334717, 0.011474549770355225, 0.04411506652832031, 0.035134315490722656, 0.020695269107818604, 0.01172792911529541, 0.013525247573852539, 0.033262431621551514, 0.029682695865631104, 0.01879936456680298, 0.07228124141693115, 0.0930253267288208, 0.012045204639434814, 0.022306203842163086, 0.0584796667098999, 0.0332069993019104, 0.042669832706451416, 0.0253065824508667, 0.047709763050079346, 0.01849120855331421, 0.0069484710693359375, 0.01700758934020996, 0.04148149490356445, 0.047530293464660645, 0.04589122533798218, 0.06942963600158691, 0.04543489217758179, 0.06903749704360962, 0.039800286293029785, 0.030711650848388672, 0.017664551734924316, 0.02809685468673706, 0.05428314208984375, 0.021359026432037354, 0.03527456521987915, 0.08155125379562378, 0.006648123264312744, 0.034356892108917236, 0.012920379638671875, 0.031894683837890625, 0.11312979459762573, 0.04223400354385376, 0.05072009563446045, 0.024098634719848633, 0.023196816444396973, 0.044606029987335205, 0.025218427181243896, 0.02630990743637085, 0.06332647800445557, 0.06996512413024902, 0.0220944881439209, 0.02311122417449951, 0.061812639236450195, 0.040679931640625, 0.012420177459716797, 0.11458322405815125, 0.05871593952178955, 0.04713636636734009, 0.07517576217651367, 0.05094045400619507, 0.09545734524726868, 0.053334951400756836, 0.0488513708114624, 0.06074643135070801, 0.06053924560546875, 0.028026103973388672, 0.00725024938583374, 0.020419180393218994, 0.05114978551864624, 0.03284567594528198, 0.0631406307220459, 0.03223061561584473, 0.18052160739898682, 0.029354393482208252, 0.047465622425079346, 0.07195484638214111, 0.08556771278381348, 0.02192080020904541, 0.03762948513031006, 0.06706702709197998, 0.027353763580322266, 0.10596227645874023, 0.0854986310005188, 0.05325573682785034, 0.02569681406021118, 0.032898902893066406, 0.047373175621032715, 0.023845136165618896, 0.05528837442398071, 0.015712738037109375, 0.06391417980194092, 0.015525281429290771, 0.08470970392227173, 0.03528839349746704, 0.023205041885375977, 0.029685914516448975, 0.056558191776275635, 0.020000100135803223, 0.0273095965385437, 0.03765428066253662, 0.014511823654174805, 0.026128709316253662, 0.0690273642539978, 0.0700942873954773, 0.04555511474609375, 0.013841748237609863, 0.024508178234100342, 0.08602505922317505, 0.03606009483337402, 0.0211983323097229, 0.015556395053863525, 0.11301642656326294, 0.028701305389404297, 0.012298345565795898, 0.060825347900390625, 0.023581087589263916, 0.007424652576446533, 0.020142078399658203, 0.030978918075561523, 0.023128867149353027, 0.014627277851104736, 0.029567062854766846, 0.03613114356994629, 0.056057095527648926, 0.04129791259765625, 0.0232924222946167, 0.014659345149993896, 0.05466586351394653, 0.004363834857940674, 0.056007564067840576, 0.06134188175201416, 0.06899785995483398, 0.017948150634765625, 0.04877424240112305, 0.02949213981628418, 0.019496440887451172, 0.07444536685943604, 0.017828404903411865, 0.06275582313537598, 0.05776482820510864, 0.020928919315338135, 0.06321984529495239, 0.04461616277694702, 0.020159244537353516, 0.0531466007232666, 0.027020156383514404, 0.021024584770202637, 0.026878774166107178, 0.017461538314819336, 0.007183670997619629, 0.048626601696014404, 0.036630988121032715, 0.018339335918426514, 0.025583386421203613, 0.02205604314804077, 0.0132598876953125, 0.05428481101989746, 0.04118454456329346, 0.0247572660446167, 0.06328147649765015, 0.1251586675643921, 0.024289190769195557, 0.05448126792907715, 0.1098257303237915, 0.037168264389038086, 0.07343220710754395, 0.011413812637329102, 0.005899250507354736, 0.06544160842895508, 0.01968538761138916, 0.011320233345031738, 0.028039216995239258, 0.027342021465301514, 0.007255256175994873, 0.04228252172470093, 0.024625003337860107, 0.09428542852401733, 0.03244912624359131, 0.10390043258666992, 0.029155373573303223, 0.11373907327651978, 0.01763308048248291, 0.056169748306274414, 0.01144397258758545, 0.08723407983779907, 0.07862019538879395, 0.02502495050430298, 0.057077229022979736, 0.05397748947143555, 0.017041027545928955, 0.08659011125564575, 0.007968723773956299, 0.02256113290786743, 0.017049551010131836, 0.037624895572662354, 0.0360797643661499, 0.018000245094299316, 0.028644144535064697, 0.02837979793548584, 0.04175412654876709, 0.08584243059158325, 0.08608418703079224, 0.04336392879486084, 0.06994330883026123, 0.05437743663787842, 0.04672592878341675, 0.0536191463470459, 0.049527525901794434, 0.0393671989440918, 0.01833367347717285, 0.020463287830352783, 0.016282379627227783, 0.0405239462852478, 0.041209399700164795, 0.045702993869781494, 0.02510547637939453, 0.029857903718948364, 0.03795856237411499, 0.1386672854423523, 0.034931719303131104, 0.08597111701965332, 0.04485112428665161, 0.03310751914978027, 0.06446343660354614, 0.009356260299682617, 0.013699948787689209, 0.04372715950012207, 0.010976850986480713, 0.05236786603927612, 0.025319218635559082, 0.03840285539627075, 0.019930720329284668, 0.05942565202713013, 0.03250151872634888, 0.02882784605026245, 0.10970014333724976, 0.04844099283218384, 0.04330641031265259, 0.04461592435836792, 0.022132158279418945, 0.02322399616241455, 0.01913130283355713, 0.0514756441116333, 0.012920081615447998, 0.08958578109741211, 0.0466727614402771, 0.07973498106002808, 0.05235147476196289, 0.08918172121047974, 0.013671278953552246, 0.030515432357788086, 0.056421637535095215, 0.029043197631835938, 0.03121209144592285, 0.052545368671417236, 0.007483184337615967, 0.040480196475982666, 0.0386011004447937, 0.08020579814910889, 0.05189436674118042, 0.010712027549743652, 0.03723365068435669, 0.015422582626342773, 0.06828218698501587, 0.035794854164123535, 0.006152510643005371, 0.023431479930877686, 0.027312278747558594, 0.032341182231903076, 0.035938918590545654, 0.07012921571731567, 0.048587799072265625, 0.02695566415786743, 0.027068495750427246, 0.038316428661346436, 0.018791913986206055, 0.02430891990661621, 0.021782755851745605, 0.039276301860809326, 0.021254539489746094, 0.04039645195007324, 0.016198456287384033, 0.0911375880241394, 0.007469356060028076, 0.026324570178985596, 0.01007455587387085, 0.0775994062423706, 0.04037564992904663, 0.032034337520599365, 0.02104109525680542, 0.011910319328308105, 0.015365660190582275, 0.03567194938659668, 0.025710880756378174, 0.09857171773910522, 0.030370116233825684, 0.026130318641662598, 0.09151524305343628, 0.02202218770980835, 0.02912205457687378, 0.05522245168685913, 0.06580215692520142, 0.031966984272003174, 0.03662455081939697, 0.025967538356781006, 0.047512590885162354, 0.05249059200286865, 0.02645587921142578, 0.013332247734069824, 0.05634111166000366, 0.025325655937194824, 0.08054667711257935, 0.04461312294006348, 0.030885159969329834, 0.01275777816772461, 0.06687301397323608, 0.010552823543548584, 0.021797597408294678, 0.027957618236541748, 0.029262781143188477, 0.014471948146820068, 0.02297419309616089, 0.038770079612731934, 0.06763321161270142, 0.04612302780151367, 0.024709045886993408, 0.036254048347473145, 0.01928126811981201, 0.014776647090911865, 0.018588483333587646, 0.016717731952667236, 0.022192299365997314, 0.026911675930023193, 0.03899586200714111, 0.018516600131988525, 0.07483083009719849, 0.1294383406639099, 0.033818185329437256, 0.03452044725418091, 0.028789043426513672, 0.015474796295166016, 0.005733788013458252, 0.05515396595001221, 0.0682826042175293, 0.16441792249679565, 0.018424630165100098, 0.012318909168243408, 0.05836296081542969, 0.014730632305145264, 0.021502673625946045, 0.04150635004043579, 0.006975412368774414, 0.04577183723449707, 0.02663511037826538, 0.04422163963317871, 0.015127420425415039, 0.06326538324356079, 0.02807021141052246, 0.0140455961227417, 0.03984475135803223, 0.06694275140762329, 0.02805107831954956, 0.03559911251068115, 0.006516516208648682, 0.026399970054626465, 0.03848522901535034, 0.0787438154220581, 0.01186591386795044, 0.017571628093719482, 0.010977685451507568, 0.03024435043334961, 0.010043144226074219, 0.08687460422515869, 0.017514407634735107, 0.05320155620574951, 0.03652912378311157, 0.027879059314727783, 0.040037333965301514, 0.029291927814483643, 0.061790525913238525, 0.01941061019897461, 0.006528794765472412, 0.021322548389434814, 0.024329304695129395, 0.05578261613845825, 0.05698293447494507, 0.04633188247680664, 0.021356821060180664, 0.08921480178833008, 0.03175848722457886, 0.02617025375366211, 0.07448279857635498, 0.009053945541381836, 0.006800353527069092, 0.06974875926971436, 0.06019186973571777, 0.03322863578796387, 0.012536346912384033, 0.07809251546859741, 0.08682817220687866, 0.01587390899658203, 0.018662452697753906, 0.09124645590782166, 0.0581241250038147, 0.057892799377441406, 0.0180627703666687, 0.025015652179718018, 0.010421395301818848, 0.02180659770965576, 0.02895498275756836, 0.014195144176483154, 0.048461854457855225, 0.046388089656829834, 0.04546076059341431, 0.09881442785263062, 0.02287203073501587, 0.02710747718811035, 0.02756822109222412, 0.053176820278167725, 0.014825820922851562, 0.029639899730682373, 0.034930646419525146, 0.026524126529693604, 0.028420090675354004]
# uot_itr = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# uot_mmd = [100, 100, 0.3134167492389679, 0.15461856126785278, 0.08517962694168091, 0.3283770680427551, 0.130773663520813, 0.33422455191612244, 0.38867416977882385, 0.3214851915836334, 0.15292766690254211, 0.017595559358596802, 0.16296520829200745, 0.22415202856063843, 0.5769946575164795, 0.2372196912765503, 0.20609915256500244, 0.3008231222629547, 0.18357685208320618, 0.2532389461994171, 0.056858450174331665, 0.03358536958694458, 0.19491499662399292, 0.10505452752113342, 0.11285868287086487, 0.22121819853782654, 0.10877180099487305, 0.06286829710006714, 0.12904244661331177, 0.03846001625061035, 0.04229152202606201, 0.09652137756347656, 0.08602917194366455, 0.022748231887817383, 0.0321354866027832, 0.07897686958312988, 0.0652802586555481, 0.06368857622146606, 0.11289101839065552, 0.12245774269104004, 0.09823405742645264, 0.06782281398773193, 0.09724003076553345, 0.035939693450927734, 0.03543651103973389, 0.04845476150512695, 0.05445826053619385, 0.08662331104278564, 0.03406476974487305, 0.02305358648300171, 0.13032644987106323, 0.05851256847381592, 0.010360479354858398, 0.04099535942077637, 0.030231356620788574, 0.036354660987854004, 0.04348897933959961, 0.09099620580673218, 0.04279518127441406, 0.014308273792266846, 0.03659045696258545, 0.02088189125061035, 0.16239744424819946, 0.019515275955200195, 0.021896958351135254, 0.02754741907119751, 0.030678749084472656, 0.027296364307403564, 0.028088927268981934, 0.0352938175201416, 0.02487814426422119, 0.042008817195892334, 0.057154059410095215, 0.13832098245620728, 0.10980409383773804, 0.029475927352905273, 0.028412461280822754, 0.02784562110900879, 0.038788795471191406, 0.09928148984909058, 0.051016271114349365, 0.09937059879302979, 0.01883023977279663, 0.022657394409179688, 0.06077837944030762, 0.06866782903671265, 0.08636868000030518, 0.13791078329086304, 0.01979386806488037, 0.038328349590301514, 0.042624711990356445, 0.02704411745071411, 0.05064576864242554, 0.039655983448028564, 0.03661149740219116, 0.03378570079803467, 0.04843020439147949, 0.035464465618133545, 0.08520543575286865, 0.03388261795043945, 0.007837474346160889, 0.06339728832244873, 0.04955708980560303, 0.02833038568496704, 0.09886366128921509, 0.02747941017150879, 0.03687542676925659, 0.024473130702972412, 0.0535738468170166, 0.02827000617980957, 0.036198973655700684, 0.011123716831207275, 0.03989100456237793, 0.032518744468688965, 0.1171114444732666, 0.09852266311645508, 0.030803322792053223, 0.05511099100112915, 0.04277557134628296, 0.046621859073638916, 0.027171611785888672, 0.04623818397521973, 0.04640626907348633, 0.03825622797012329, 0.03468489646911621, 0.0422326922416687, 0.008976578712463379, 0.027916312217712402, 0.054944634437561035, 0.01655513048171997, 0.05337071418762207, 0.02451467514038086, 0.06379544734954834, 0.04256272315979004, 0.012698948383331299, 0.017776906490325928, 0.052186012268066406, 0.05645573139190674, 0.013959169387817383, 0.02965676784515381, 0.057929039001464844, 0.08423125743865967, 0.0763930082321167, 0.038619399070739746, 0.09411078691482544, 0.0223158597946167, 0.013586044311523438, 0.04983246326446533, 0.0491294264793396, 0.04725438356399536, 0.02467888593673706, 0.035256922245025635, 0.03480207920074463, 0.03839921951293945, 0.030013442039489746, 0.0034016966819763184, 0.11538702249526978, 0.08031004667282104, 0.05753469467163086, 0.013891994953155518, 0.027195990085601807, 0.013888120651245117, 0.014425873756408691, 0.012991905212402344, 0.02320200204849243, 0.005331158638000488, 0.027942180633544922, 0.09446865320205688, 0.02058279514312744, 0.027589499950408936, 0.04978346824645996, 0.02321338653564453, 0.05428755283355713, 0.04069411754608154, 0.021372675895690918, 0.026255011558532715, 0.04116421937942505, 0.037631213665008545, 0.02987802028656006, 0.08314156532287598, 0.049752116203308105, 0.027692019939422607, 0.04284399747848511, 0.07124876976013184, 0.07756632566452026, 0.013962388038635254, 0.023798346519470215, 0.018421471118927002, 0.06402814388275146, 0.06050163507461548, 0.019900202751159668, 0.040891051292419434, 0.02527022361755371, 0.03848695755004883, 0.09236693382263184, 0.021679043769836426, 0.04533940553665161, 0.031928300857543945, 0.037990570068359375, 0.11036396026611328, 0.08871340751647949, 0.014039337635040283, 0.11094772815704346, 0.03301113843917847, 0.0288582444190979, 0.01903367042541504, 0.03525590896606445, 0.11197030544281006, 0.06553298234939575, 0.07960760593414307, 0.013913989067077637, 0.03777146339416504, 0.04397284984588623, 0.03708982467651367, 0.055052220821380615, 0.06344103813171387, 0.028920650482177734, 0.018754005432128906, 0.0431479811668396, 0.022600531578063965, 0.020825505256652832, 0.039141058921813965, 0.03906869888305664, 0.050406813621520996, 0.012412309646606445, 0.06805980205535889, 0.05496281385421753, 0.036461830139160156, 0.06287646293640137, 0.01641547679901123, 0.02931678295135498, 0.017811715602874756, 0.0865175724029541, 0.037662625312805176, 0.07118690013885498, 0.09776782989501953, 0.07273733615875244, 0.07686793804168701, 0.044044435024261475, 0.0430639386177063, 0.020896315574645996, 0.008305549621582031, 0.028356313705444336, 0.12585577368736267, 0.05808675289154053, 0.019244909286499023, 0.015799522399902344, 0.012257635593414307, 0.041695594787597656, 0.021341562271118164, 0.04058295488357544, 0.022203445434570312, 0.09993970394134521, 0.09435981512069702, 0.019180893898010254, 0.009995043277740479, 0.06772536039352417, 0.044867634773254395, 0.026162028312683105, 0.028388619422912598, 0.12835693359375, 0.045891404151916504, 0.02918630838394165, 0.0393064022064209, 0.03299832344055176, 0.08044075965881348, 0.07778120040893555, 0.05245840549468994, 0.09145623445510864, 0.10723739862442017, 0.06761080026626587, 0.03156644105911255, 0.06193822622299194, 0.039891719818115234, 0.03307163715362549, 0.052478134632110596, 0.026133358478546143, 0.12465494871139526, 0.029389262199401855, 0.08661758899688721, 0.13016057014465332, 0.06985723972320557, 0.07427769899368286, 0.03709307312965393, 0.055866539478302, 0.12197774648666382, 0.050040483474731445, 0.07169771194458008, 0.06369185447692871, 0.046409428119659424, 0.03839552402496338, 0.06181401014328003, 0.03390800952911377, 0.01840895414352417, 0.05318856239318848, 0.03718757629394531, 0.1382848024368286, 0.026660621166229248, 0.033173441886901855, 0.06197589635848999, 0.01930224895477295, 0.036235928535461426, 0.02271580696105957, 0.03522002696990967, 0.03877723217010498, 0.08437991142272949, 0.04592663049697876, 0.04899883270263672, 0.007260799407958984, 0.09850859642028809, 0.011446356773376465, 0.030231356620788574, 0.06511855125427246, 0.017169415950775146, 0.013985157012939453, 0.04847872257232666, 0.07519447803497314, 0.014537453651428223, 0.012494802474975586, 0.024029850959777832, 0.037793874740600586, 0.06069856882095337, 0.023482143878936768, 0.0056664347648620605, 0.03029012680053711, 0.03290238976478577, 0.15614616870880127, 0.02099752426147461, 0.04747450351715088, 0.012359023094177246, 0.04293262958526611, 0.031493306159973145, 0.1600307822227478, 0.019578099250793457, 0.051485657691955566, 0.01189875602722168, 0.06910955905914307, 0.04571342468261719, 0.06560736894607544, 0.055857330560684204, 0.023109614849090576, 0.02795332670211792, 0.019120872020721436, 0.02900397777557373, 0.055361807346343994, 0.04096400737762451, 0.03491246700286865, 0.05276459455490112, 0.020006656646728516, 0.03979313373565674, 0.026717007160186768, 0.020299017429351807, 0.013768613338470459, 0.033966124057769775, 0.07333248853683472, 0.04004889726638794, 0.021324753761291504, 0.029718995094299316, 0.016992509365081787, 0.030509591102600098, 0.03360188007354736, 0.1181633472442627, 0.039547741413116455, 0.09015625715255737, 0.030670464038848877, 0.04911905527114868, 0.044825077056884766, 0.0103493332862854, 0.02354651689529419, 0.022348105907440186, 0.05929756164550781, 0.05151182413101196, 0.05225092172622681, 0.009773492813110352, 0.014638006687164307, 0.033463239669799805, 0.011145412921905518, 0.08910933136940002, 0.1534252166748047, 0.02934819459915161, 0.0918152928352356, 0.04065948724746704, 0.06184345483779907, 0.024706542491912842, 0.028698384761810303, 0.025351881980895996, 0.024227499961853027, 0.04975447058677673, 0.027801871299743652, 0.03697091341018677, 0.04575318098068237, 0.07546654343605042, 0.06631353497505188, 0.025287985801696777, 0.02299898862838745, 0.04807329177856445, 0.03658634424209595, 0.08662420511245728, 0.011335253715515137, 0.05550944805145264, 0.025166630744934082, 0.032538533210754395, 0.014909863471984863, 0.0205422043800354, 0.013034939765930176, 0.05798161029815674, 0.04704862833023071, 0.02089989185333252, 0.02767014503479004, 0.01903367042541504, 0.01767808198928833, 0.09913039207458496, 0.08534181118011475, 0.04649507999420166, 0.04672330617904663, 0.03941762447357178, 0.036791861057281494, 0.049409329891204834, 0.02769756317138672, 0.07663089036941528, 0.03252685070037842, 0.02695232629776001, 0.05465632677078247, 0.015077710151672363, 0.04219710826873779, 0.03406107425689697, 0.04508548974990845, 0.06299692392349243, 0.0369228720664978, 0.05225783586502075, 0.05104625225067139, 0.025797605514526367, 0.05450904369354248, 0.08342927694320679, 0.11122024059295654, 0.08154177665710449, 0.06648004055023193, 0.030163884162902832, 0.07233446836471558, 0.024134695529937744, 0.043826520442962646, 0.01825582981109619, 0.052130937576293945, 0.05747276544570923, 0.10941451787948608, 0.047008216381073, 0.022329628467559814, 0.06735140085220337, 0.04068148136138916, 0.03605496883392334, 0.07662081718444824, 0.06105160713195801, 0.0345267653465271, 0.18987077474594116, 0.053463101387023926, 0.03099191188812256, 0.028820812702178955, 0.03920876979827881, 0.04489457607269287, 0.0522153377532959, 0.07357901334762573, 0.04165542125701904, 0.037544965744018555, 0.06358891725540161, 0.013545691967010498, 0.058465778827667236, 0.022770226001739502, 0.06415438652038574, 0.03777956962585449, 0.011383414268493652, 0.05016505718231201, 0.2036687135696411, 0.03359031677246094, 0.03762775659561157, 0.022150516510009766, 0.024139404296875, 0.02706366777420044, 0.04629826545715332, 0.09922575950622559, 0.053090035915374756, 0.03624546527862549, 0.1293497085571289, 0.01952946186065674, 0.05165672302246094, 0.02264559268951416, 0.026868045330047607, 0.05753147602081299, 0.033219218254089355, 0.05497235059738159, 0.050019025802612305, 0.028630733489990234, 0.016636371612548828, 0.02213454246520996, 0.028046250343322754, 0.07292938232421875, 0.04809916019439697, 0.00734400749206543, 0.01983940601348877, 0.017850518226623535, 0.02634751796722412]
#
#
# t = 20
# plt.plot(ot_itr[t:], ot_mmd[t:], label="OT")
# plt.plot(uot_itr[t:], uot_mmd[t:], label="UOT")
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.title('Trainging samples:{}, Test samples:{}'.format(128,20))
# plt.legend()
# plt.show()
#
# # 1000 train, 20 test MMD
# ot_itr=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# ot_mmd=[0.37591245770454407, 0.19806796312332153, 0.2875603139400482, 0.5673239231109619, 0.12497812509536743, 0.24756857752799988, 0.3923608064651489, 0.22836129367351532, 0.29097920656204224, 0.22362801432609558, 0.08762896060943604, 0.15109649300575256, 0.14993980526924133, 0.07735702395439148, 0.07686373591423035, 0.054297953844070435, 0.04157125949859619, 0.03511589765548706, 0.05961257219314575, 0.15242964029312134, 0.035481154918670654, 0.010096609592437744, 0.006174683570861816, 0.0834774374961853, 0.02608710527420044, 0.02552783489227295, 0.027138352394104004, 0.03238070011138916, 0.05957990884780884, 0.011085033416748047, 0.05718660354614258, 0.01855325698852539, 0.014799296855926514, 0.030833840370178223, 0.013874411582946777, 0.020652294158935547, 0.041055381298065186, 0.06981110572814941, 0.032479047775268555, 0.02242332696914673, 0.026203632354736328, 0.015273034572601318, 0.022914230823516846, 0.012159764766693115, 0.028866231441497803, 0.02621561288833618, 0.047340571880340576, 0.07023048400878906, 0.06618410348892212, 0.17430317401885986, 0.04465264081954956, 0.04938000440597534, 0.061253130435943604, 0.03364717960357666, 0.03833627700805664, 0.01772230863571167, 0.0075591206550598145, 0.019154667854309082, 0.03892016410827637, 0.04421377182006836, 0.0643082857131958, 0.00579679012298584, 0.04099249839782715, 0.03128856420516968, 0.05841207504272461, 0.03516185283660889, 0.023819386959075928, 0.043306827545166016, 0.008101284503936768, 0.0391535758972168, 0.02814549207687378, 0.017393648624420166, 0.004529237747192383, 0.08886730670928955, 0.02827584743499756, 0.035313189029693604, 0.012618839740753174, 0.016889631748199463, 0.04287821054458618, 0.0301206111907959, 0.024240851402282715, 0.03474515676498413, 0.02692413330078125, 0.025411546230316162, 0.026967883110046387, 0.03462707996368408, 0.02020096778869629, 0.01370781660079956, 0.10978758335113525, 0.012462794780731201, 0.005978405475616455, 0.04702913761138916, 0.025356531143188477, 0.035388827323913574, 0.012539982795715332, 0.062191009521484375, 0.014680027961730957, 0.051565706729888916, 0.016890645027160645, 0.02546769380569458, 0.010422825813293457, 0.035492539405822754, 0.034355759620666504, 0.02526456117630005, 0.021967589855194092, 0.007872819900512695, 0.060796916484832764, 0.04143935441970825, 0.016167104244232178, 0.027320146560668945, 0.05283617973327637, 0.0210837721824646, 0.08357274532318115, 0.02155083417892456, 0.0075043439865112305, 0.03267049789428711, 0.028754353523254395, 0.05194807052612305, 0.05809581279754639, 0.04313436150550842, 0.046839892864227295, 0.07409524917602539, 0.030913472175598145, 0.037279367446899414, 0.0608784556388855, 0.03559458255767822, 0.05689126253128052, 0.11232423782348633, 0.06435739994049072, 0.025693118572235107, 0.018894970417022705, 0.04756927490234375, 0.03545135259628296, 0.008260011672973633, 0.01565307378768921, 0.02512603998184204, 0.016382992267608643, 0.04486119747161865, 0.009213924407958984, 0.01034313440322876, 0.030906975269317627, 0.04137837886810303, 0.026809394359588623, 0.0981702208518982, 0.058180153369903564, 0.09658503532409668, 0.016909658908843994, 0.0715143084526062, 0.06061148643493652, 0.006018519401550293, 0.01868075132369995, 0.019758880138397217, 0.04458707571029663, 0.02576380968093872, 0.04860210418701172, 0.03557932376861572, 0.011869966983795166, 0.0343937873840332, 0.020737886428833008, 0.0037668347358703613, 0.014794707298278809, 0.02003800868988037, 0.011083126068115234, 0.02208411693572998, 0.021987497806549072, 0.04761141538619995, 0.03013467788696289, 0.06216013431549072, 0.019473493099212646, 0.018910646438598633, 0.007818222045898438, 0.06782162189483643, 0.08310931921005249, 0.060449421405792236, 0.026578843593597412, 0.030859947204589844, 0.02510511875152588, 0.0027579665184020996, 0.017865538597106934, 0.03480565547943115, 0.04936259984970093, 0.01974034309387207, 0.05488848686218262, 0.049291253089904785, 0.06140422821044922, 0.01480013132095337, 0.006829380989074707, 0.015412509441375732, 0.057769954204559326, 0.04282736778259277, 0.02741938829421997, 0.006630897521972656, 0.04658234119415283, 0.07678604125976562, 0.06255847215652466, 0.03827148675918579, 0.020458579063415527, 0.0894097089767456, 0.08200335502624512, 0.02384054660797119, 0.022740066051483154, 0.06936931610107422, 0.03460580110549927, 0.03665280342102051, 0.02799004316329956, 0.05677610635757446, 0.010352611541748047, 0.03102189302444458, 0.008700013160705566, 0.03422290086746216, 0.05977600812911987, 0.010348379611968994, 0.09380865097045898, 0.03403878211975098, 0.02351987361907959, 0.025690197944641113, 0.06126445531845093, 0.012307405471801758, 0.0351099967956543, 0.047263920307159424, 0.012237310409545898, 0.0253869891166687, 0.043138742446899414, 0.037753283977508545, 0.01941680908203125, 0.07558542490005493, 0.022423148155212402, 0.028304576873779297, 0.14416521787643433, 0.03701144456863403, 0.031242311000823975, 0.010538756847381592, 0.06920123100280762, 0.010543882846832275, 0.03883767127990723, 0.07845145463943481, 0.028785109519958496, 0.055166423320770264, 0.029877424240112305, 0.028187096118927002, 0.018626630306243896, 0.04966092109680176, 0.07205843925476074, 0.14520955085754395, 0.024784624576568604, 0.024762630462646484, 0.00869971513748169, 0.10340487957000732, 0.010579168796539307, 0.08123034238815308, 0.058262646198272705, 0.03215467929840088, 0.026471734046936035, 0.013814926147460938, 0.01096189022064209, 0.05351632833480835, 0.030860483646392822, 0.02032691240310669, 0.020688414573669434, 0.04179126024246216, 0.015369772911071777, 0.05948317050933838, 0.04291719198226929, 0.039200782775878906, 0.04294401407241821, 0.018469274044036865, 0.009868025779724121, 0.03282862901687622, 0.04660630226135254, 0.10130196809768677, 0.018112361431121826, 0.07629364728927612, 0.03538137674331665, 0.03204381465911865, 0.01290518045425415, 0.009638309478759766, 0.01573324203491211, 0.0480194091796875, 0.005726277828216553, 0.016820132732391357, 0.08467692136764526, 0.035530686378479004, 0.00829857587814331, 0.058921992778778076, 0.07112610340118408, 0.029437899589538574, 0.028860926628112793, 0.1615273356437683, 0.023432552814483643, 0.07173049449920654, 0.006982743740081787, 0.09661674499511719, 0.03053295612335205, 0.03144711256027222, 0.0527072548866272, 0.01738506555557251, 0.028643429279327393, 0.027558624744415283, 0.06597799062728882, 0.026777446269989014, 0.030476629734039307, 0.060474008321762085, 0.018854260444641113, 0.018069028854370117, 0.024455904960632324, 0.032257914543151855, 0.06736588478088379, 0.07473570108413696, 0.06360572576522827, 0.04435932636260986, 0.007996201515197754, 0.011841416358947754, 0.013769030570983887, 0.011399626731872559, 0.016292095184326172, 0.012140870094299316, 0.055804669857025146, 0.034356772899627686, 0.010568559169769287, 0.04635357856750488, 0.010645627975463867, 0.02600836753845215, 0.03198820352554321, 0.011446237564086914, 0.04466521739959717, 0.014217555522918701, 0.07996678352355957, 0.025190114974975586, 0.02343815565109253, 0.05995619297027588, 0.06681227684020996, 0.03435158729553223, 0.06172454357147217, 0.0533563494682312, 0.0194852352142334, 0.01627981662750244, 0.06619095802307129, 0.03915727138519287, 0.024940311908721924, 0.05014240741729736, 0.1077646017074585, 0.05094265937805176, 0.03607887029647827, 0.02881103754043579, 0.0035172700881958008, 0.040833234786987305, 0.05841439962387085, 0.044135212898254395, 0.007801234722137451, 0.05978834629058838, 0.010618031024932861, 0.03600800037384033, 0.03754788637161255, 0.030305206775665283, 0.02070063352584839, 0.021639108657836914, 0.02745884656906128, 0.03762507438659668, 0.043086886405944824, 0.032082974910736084, 0.01962459087371826, 0.033927977085113525, 0.02716207504272461, 0.043821871280670166, 0.008497297763824463, 0.07192224264144897, 0.024123430252075195, 0.016498923301696777, 0.027372539043426514, 0.015997767448425293, 0.03326505422592163, 0.02269279956817627, 0.03729361295700073, 0.0105019211769104, 0.01588737964630127, 0.013630807399749756, 0.016998767852783203, 0.030970335006713867, 0.035844624042510986, 0.05387747287750244, 0.027937114238739014, 0.05407226085662842, 0.03747934103012085, 0.09160381555557251, 0.015219509601593018, 0.029351890087127686, 0.019845902919769287, 0.031155407428741455, 0.019354939460754395, 0.018032073974609375, 0.034720420837402344, 0.028571486473083496, 0.03814888000488281, 0.025614142417907715, 0.05138903856277466, 0.031194329261779785, 0.13699021935462952, 0.04361516237258911, 0.03386950492858887, 0.027764558792114258, 0.03433096408843994, 0.044676363468170166, 0.012607276439666748, 0.009270310401916504, 0.06673562526702881, 0.022085487842559814, 0.029262304306030273, 0.030153989791870117, 0.05662161111831665, 0.022827208042144775, 0.009150028228759766, 0.07416874170303345, 0.04391998052597046, 0.06225776672363281, 0.04404634237289429, 0.03089141845703125, 0.010816693305969238, 0.0350307822227478, 0.03719085454940796, 0.033922672271728516, 0.017159759998321533, 0.032665371894836426, 0.016040027141571045, 0.019728660583496094, 0.061632633209228516, 0.0036790966987609863, 0.041356563568115234, 0.009586215019226074, 0.02098715305328369, 0.03653395175933838, 0.030346691608428955, 0.019485056400299072, 0.11516672372817993, 0.037563860416412354, 0.03755176067352295, 0.017661750316619873, 0.05388355255126953, 0.029596269130706787, 0.0551685094833374, 0.025597572326660156, 0.034775733947753906, 0.034931063652038574, 0.007904469966888428, 0.03517407178878784, 0.03917431831359863, 0.1603826880455017, 0.024091660976409912, 0.011649370193481445, 0.07640105485916138, 0.06268560886383057, 0.02485901117324829, 0.019353210926055908, 0.013348639011383057, 0.03521275520324707, 0.03950703144073486, 0.020676612854003906, 0.04125010967254639, 0.04810285568237305, 0.019857585430145264, 0.013749957084655762, 0.10689622163772583, 0.04310750961303711, 0.016032159328460693, 0.02165764570236206, 0.035520076751708984, 0.03570914268493652, 0.031038939952850342, 0.040130436420440674, 0.01831609010696411, 0.07523280382156372, 0.025507032871246338, 0.03253060579299927, 0.04055929183959961, 0.08166247606277466, 0.021696507930755615, 0.10909008979797363, 0.0351564884185791, 0.021106958389282227, 0.023571550846099854, 0.011560022830963135, 0.03840428590774536, 0.007277369499206543, 0.06106698513031006, 0.1404656171798706, 0.00948333740234375, 0.023929357528686523, 0.024466276168823242, 0.00850212574005127, 0.007441580295562744, 0.014618456363677979, 0.14043110609054565, 0.006124615669250488, 0.0899474024772644, 0.019664525985717773, 0.05565071105957031, 0.011296570301055908, 0.05443161725997925, 0.03171873092651367, 0.02502840757369995, 0.035560548305511475]
#
# uot_itr=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# uot_mmd=[100, 0.9120103120803833, 0.32059162855148315, 0.24043336510658264, 0.24406230449676514, 0.29013311862945557, 0.18991702795028687, 0.4357091188430786, 0.3323104977607727, 0.1369537115097046, 0.13610178232192993, 0.21821996569633484, 0.23380917310714722, 0.3726157546043396, 0.2570502460002899, 0.19639161229133606, 0.10239517688751221, 0.2417597770690918, 0.027677714824676514, 0.12509149312973022, 0.1520543098449707, 0.08206698298454285, 0.17323988676071167, 0.12665611505508423, 0.08570140600204468, 0.0824919044971466, 0.13050517439842224, 0.12075081467628479, 0.13500630855560303, 0.0699743926525116, 0.11039352416992188, 0.08268263936042786, 0.07715189456939697, 0.10377591848373413, 0.09096020460128784, 0.08641618490219116, 0.09837955236434937, 0.06585174798965454, 0.08851546049118042, 0.04243111610412598, 0.03150826692581177, 0.049100518226623535, 0.011437594890594482, 0.03838515281677246, 0.01850074529647827, 0.040033161640167236, 0.033848702907562256, 0.06886962056159973, 0.013060927391052246, 0.03365296125411987, 0.020576775074005127, 0.032988786697387695, 0.051427602767944336, 0.05721336603164673, 0.03145766258239746, 0.03862714767456055, 0.05351775884628296, 0.08158385753631592, 0.017594873905181885, 0.02787071466445923, 0.042214035987854004, 0.1628715991973877, 0.05706387758255005, 0.02656644582748413, 0.05720356106758118, 0.048964858055114746, 0.023318350315093994, 0.010720551013946533, 0.037078022956848145, 0.03169971704483032, 0.038865506649017334, 0.01290738582611084, 0.05958205461502075, 0.07875990867614746, 0.02956324815750122, 0.017273902893066406, 0.020962417125701904, 0.07901787757873535, 0.010214149951934814, 0.06546533107757568, 0.006215333938598633, 0.014621436595916748, 0.03666806221008301, 0.057934343814849854, 0.045099854469299316, 0.06466972827911377, 0.027616024017333984, 0.037411391735076904, 0.052733540534973145, 0.022907793521881104, 0.03526568412780762, 0.030728161334991455, 0.022897660732269287, 0.018626153469085693, 0.03349405527114868, 0.01566934585571289, 0.009477794170379639, 0.015141129493713379, 0.031286418437957764, 0.034650981426239014, 0.011472165584564209, 0.024928390979766846, 0.036127686500549316, 0.007829368114471436, 0.015459954738616943, 0.020314455032348633, 0.032942891120910645, 0.0908399224281311, 0.06368893384933472, 0.009268343448638916, 0.011997699737548828, 0.02961832284927368, 0.04358702898025513, 0.016550540924072266, 0.0626336932182312, 0.01459038257598877, 0.023010671138763428, 0.024826526641845703, 0.03096252679824829, 0.014177322387695312, 0.07002276182174683, 0.034465909004211426, 0.0205344557762146, 0.023885071277618408, 0.07082253694534302, 0.049358367919921875, 0.04198688268661499, 0.0395122766494751, 0.02925264835357666, 0.021947145462036133, 0.028756797313690186, 0.026435017585754395, 0.06239694356918335, 0.026487648487091064, 0.0725562572479248, 0.03288906812667847, 0.027030587196350098, 0.017424166202545166, 0.058057963848114014, 0.055556416511535645, 0.10892951488494873, 0.03239840269088745, 0.03446698188781738, 0.06289350986480713, 0.012636244297027588, 0.020230472087860107, 0.037127792835235596, 0.06383395195007324, 0.03831219673156738, 0.06515955924987793, 0.022390007972717285, 0.022983312606811523, 0.026715755462646484, 0.016343116760253906, 0.015707552433013916, 0.022144854068756104, 0.034042537212371826, 0.02566319704055786, 0.04391986131668091, 0.11696779727935791, 0.027414143085479736, 0.03757500648498535, 0.026587843894958496, 0.007458806037902832, 0.00948244333267212, 0.08027380704879761, 0.03516954183578491, 0.006970643997192383, 0.03873884677886963, 0.04447674751281738, 0.029987871646881104, 0.047875821590423584, 0.027392923831939697, 0.005085170269012451, 0.008948087692260742, 0.033391594886779785, 0.009396612644195557, 0.05157291889190674, 0.018612146377563477, 0.05323970317840576, 0.0401308536529541, 0.08080345392227173, 0.04150855541229248, 0.04591953754425049, 0.017833411693572998, 0.017660081386566162, 0.01675868034362793, 0.06309688091278076, 0.0101088285446167, 0.07581347227096558, 0.014400303363800049, 0.05251032114028931, 0.03515869379043579, 0.011732161045074463, 0.06434065103530884, 0.0484844446182251, 0.03739809989929199, 0.03405040502548218, 0.008352458477020264, 0.06704109907150269, 0.014131724834442139, 0.07246488332748413, 0.05803030729293823, 0.032040178775787354, 0.05807763338088989, 0.01877737045288086, 0.04628145694732666, 0.015461862087249756, 0.006400108337402344, 0.06285679340362549, 0.023746728897094727, 0.01487588882446289, 0.045407772064208984, 0.03273075819015503, 0.029652655124664307, 0.03584259748458862, 0.03153640031814575, 0.04578655958175659, 0.007061183452606201, 0.061505794525146484, 0.0800963044166565, 0.05296450853347778, 0.03179746866226196, 0.07432681322097778, 0.015478372573852539, 0.012789726257324219, 0.04505765438079834, 0.02955150604248047, 0.010036468505859375, 0.016369879245758057, 0.05137443542480469, 0.027086973190307617, 0.054241299629211426, 0.01665419340133667, 0.08700186014175415, 0.028487801551818848, 0.10577958822250366, 0.05177187919616699, 0.03882092237472534, 0.07617330551147461, 0.02018582820892334, 0.04901379346847534, 0.021292567253112793, 0.07301187515258789, 0.028252065181732178, 0.009445488452911377, 0.02995997667312622, 0.024359464645385742, 0.03874152898788452, 0.07655805349349976, 0.19206029176712036, 0.033773839473724365, 0.10646003484725952, 0.024136662483215332, 0.0365106463432312, 0.07791107892990112, 0.014748632907867432, 0.03292137384414673, 0.01877838373184204, 0.053340137004852295, 0.018990039825439453, 0.01610279083251953, 0.12405741214752197, 0.0338289737701416, 0.01684480905532837, 0.03648114204406738, 0.05759197473526001, 0.0673266053199768, 0.00852811336517334, 0.049628257751464844, 0.009117960929870605, 0.11582452058792114, 0.033460140228271484, 0.014084815979003906, 0.05579143762588501, 0.07682168483734131, 0.015684962272644043, 0.01373147964477539, 0.03133434057235718, 0.02096182107925415, 0.009423911571502686, 0.03887641429901123, 0.06817257404327393, 0.03307396173477173, 0.10561621189117432, 0.05386537313461304, 0.048663556575775146, 0.07893818616867065, 0.01473909616470337, 0.03065401315689087, 0.0523870587348938, 0.008804380893707275, 0.07159155607223511, 0.06018519401550293, 0.016595184803009033, 0.0031273961067199707, 0.040543973445892334, 0.03192758560180664, 0.07770013809204102, 0.07528787851333618, 0.03227674961090088, 0.023272991180419922, 0.009388327598571777, 0.02962017059326172, 0.02975231409072876, 0.04366660118103027, 0.02674657106399536, 0.023412227630615234, 0.03420400619506836, 0.04310178756713867, 0.028813660144805908, 0.06713509559631348, 0.07959526777267456, 0.029549062252044678, 0.010555088520050049, 0.07159292697906494, 0.01171940565109253, 0.01700383424758911, 0.06124544143676758, 0.08476835489273071, 0.02782827615737915, 0.0345538854598999, 0.04140305519104004, 0.03677600622177124, 0.02618849277496338, 0.025402724742889404, 0.05509817600250244, 0.05201113224029541, 0.12268680334091187, 0.0511246919631958, 0.0284155011177063, 0.030245304107666016, 0.009552240371704102, 0.03880429267883301, 0.047708332538604736, 0.043364644050598145, 0.1250854730606079, 0.034917235374450684, 0.041203975677490234, 0.018024444580078125, 0.01707381010055542, 0.07513546943664551, 0.014173328876495361, 0.03386789560317993, 0.026530802249908447, 0.04543823003768921, 0.051077425479888916, 0.0370631217956543, 0.01224052906036377, 0.02595120668411255, 0.04709845781326294, 0.026080727577209473, 0.0395054817199707, 0.015608370304107666, 0.04161369800567627, 0.05004793405532837, 0.04596900939941406, 0.02382826805114746, 0.061913907527923584, 0.05300694704055786, 0.06249880790710449, 0.06546574831008911, 0.035815298557281494, 0.03372299671173096, 0.011171102523803711, 0.03431183099746704, 0.06666582822799683, 0.035520851612091064, 0.033507585525512695, 0.03775227069854736, 0.03589862585067749, 0.02739393711090088, 0.042904555797576904, 0.11603474617004395, 0.008677124977111816, 0.05776435136795044, 0.01726919412612915, 0.01018679141998291, 0.019559860229492188, 0.0188865065574646, 0.03420209884643555, 0.025825142860412598, 0.011757075786590576, 0.15427720546722412, 0.024419426918029785, 0.039759814739227295, 0.007156014442443848, 0.03195333480834961, 0.04478013515472412, 0.05074721574783325, 0.06700390577316284, 0.07034438848495483, 0.01482003927230835, 0.0676918625831604, 0.0374872088432312, 0.025244712829589844, 0.030006706714630127, 0.05304437875747681, 0.05335026979446411, 0.07398271560668945, 0.006897687911987305, 0.09781169891357422, 0.07223039865493774, 0.013543128967285156, 0.060338616371154785, 0.020831167697906494, 0.007104456424713135, 0.048197925090789795, 0.04227322340011597, 0.04558897018432617, 0.026271939277648926, 0.030488669872283936, 0.08647668361663818, 0.011540710926055908, 0.011734962463378906, 0.014596700668334961, 0.028306901454925537, 0.06963467597961426, 0.04781913757324219, 0.057263970375061035, 0.06336921453475952, 0.011966049671173096, 0.04350513219833374, 0.056456804275512695, 0.015251636505126953, 0.03816640377044678, 0.04361456632614136, 0.049374938011169434, 0.010986506938934326, 0.012342751026153564, 0.02261251211166382, 0.058009982109069824, 0.0392337441444397, 0.0356178879737854, 0.022120356559753418, 0.05847656726837158, 0.019144892692565918, 0.01791304349899292, 0.05664294958114624, 0.04421013593673706, 0.035064101219177246, 0.019252777099609375, 0.12143814563751221, 0.04041862487792969, 0.06663775444030762, 0.057516396045684814, 0.0488472580909729, 0.013045668601989746, 0.028406798839569092, 0.020763874053955078, 0.03183251619338989, 0.028740108013153076, 0.04927343130111694, 0.006706416606903076, 0.029634177684783936, 0.025860190391540527, 0.034388601779937744, 0.01876962184906006, 0.06001847982406616, 0.018976807594299316, 0.0798262357711792, 0.02403402328491211, 0.05509871244430542, 0.01997274160385132, 0.09889572858810425, 0.03486359119415283, 0.03272891044616699, 0.04264599084854126, 0.023030877113342285, 0.027286827564239502, 0.0073122382164001465, 0.014731824398040771, 0.01374828815460205, 0.013893723487854004, 0.02472025156021118, 0.04482001066207886, 0.10293138027191162, 0.04829663038253784, 0.019599854946136475, 0.0637657642364502, 0.012087404727935791, 0.03992396593093872, 0.039795517921447754, 0.04752391576766968, 0.04448780417442322, 0.03247487545013428, 0.10585153102874756, 0.014838814735412598, 0.037103354930877686, 0.022700846195220947, 0.022001922130584717, 0.060354530811309814, 0.020425021648406982, 0.09573203325271606, 0.15726596117019653, 0.03112393617630005, 0.016167759895324707, 0.018632352352142334, 0.012076616287231445, 0.010657250881195068]
# t = 20
# plt.plot(ot_itr[t:], ot_mmd[t:], label="OT")
# plt.plot(uot_itr[t:], uot_mmd[t:], label="UOT")
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.title('Trainging samples:{}, Test samples:{}'.format(1000,20))
# plt.legend()
# plt.show()

# # 2000 train, 20 test MMD, fixed sample(not resample)
# ot_itr=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# ot_mmd=[0.4130097031593323, 0.22270093858242035, 0.31385937333106995, 0.5366154909133911, 0.1573413908481598, 0.14370599389076233, 0.16017338633537292, 0.1317351758480072, 0.24161240458488464, 0.18136504292488098, 0.30353549122810364, 0.27780938148498535, 0.18322566151618958, 0.16617274284362793, 0.213532954454422, 0.34625110030174255, 0.2499125897884369, 0.11827799677848816, 0.11041224002838135, 0.09936907887458801, 0.08150848746299744, 0.13431912660598755, 0.026947617530822754, 0.030446350574493408, 0.03379786014556885, 0.08003544807434082, 0.07753866910934448, 0.04206341505050659, 0.014816462993621826, 0.05559796094894409, 0.09136074781417847, 0.046589016914367676, 0.10666677355766296, 0.017184734344482422, 0.0860600471496582, 0.04239916801452637, 0.1060226559638977, 0.010889530181884766, 0.02176952362060547, 0.05449509620666504, 0.09313231706619263, 0.08518099784851074, 0.025915563106536865, 0.051868319511413574, 0.011670172214508057, 0.039934515953063965, 0.0160180926322937, 0.012130320072174072, 0.07194602489471436, 0.016999244689941406, 0.09065520763397217, 0.020017027854919434, 0.010765314102172852, 0.05225968360900879, 0.03702414035797119, 0.052411437034606934, 0.04031085968017578, 0.05416172742843628, 0.020350515842437744, 0.1221308708190918, 0.04947251081466675, 0.06542116403579712, 0.0074211955070495605, 0.06997138261795044, 0.038894712924957275, 0.009858787059783936, 0.043600618839263916, 0.02006661891937256, 0.03135651350021362, 0.04760777950286865, 0.03532344102859497, 0.08133471012115479, 0.01095271110534668, 0.06991732120513916, 0.04665267467498779, 0.01590043306350708, 0.03054630756378174, 0.006669521331787109, 0.014522969722747803, 0.04829329252243042, 0.004812896251678467, 0.00830918550491333, 0.014337420463562012, 0.08557480573654175, 0.047099292278289795, 0.0345456600189209, 0.09184283018112183, 0.04232126474380493, 0.056184470653533936, 0.025238990783691406, 0.04927408695220947, 0.02307373285293579, 0.019632995128631592, 0.08825653791427612, 0.04294538497924805, 0.006502091884613037, 0.04663282632827759, 0.029424846172332764, 0.019369959831237793, 0.05563497543334961, 0.05363947153091431, 0.03310203552246094, 0.024386942386627197, 0.056630492210388184, 0.02347719669342041, 0.0752413272857666, 0.037763357162475586, 0.09117943048477173, 0.0210229754447937, 0.013775467872619629, 0.03414452075958252, 0.021551549434661865, 0.016227304935455322, 0.04029834270477295, 0.04184466600418091, 0.04478275775909424, 0.012429416179656982, 0.016339242458343506, 0.021540701389312744, 0.022151291370391846, 0.01598644256591797, 0.04029601812362671, 0.021480798721313477, 0.020012080669403076, 0.12827348709106445, 0.09333020448684692, 0.018502354621887207, 0.03336632251739502, 0.05632627010345459, 0.008307576179504395, 0.00865095853805542, 0.015336334705352783, 0.032543063163757324, 0.03922551870346069, 0.024089515209197998, 0.015128493309020996, 0.09219598770141602, 0.01243126392364502, 0.0278359055519104, 0.013551652431488037, 0.0037941336631774902, 0.03144502639770508, 0.06165117025375366, 0.03358525037765503, 0.01230311393737793, 0.021677136421203613, 0.015582919120788574, 0.02939605712890625, 0.008709251880645752, 0.06731164455413818, 0.06539428234100342, 0.016080021858215332, 0.009890258312225342, 0.022079050540924072, 0.04210245609283447, 0.017068326473236084, 0.005380094051361084, 0.02404022216796875, 0.05423516035079956, 0.03747183084487915, 0.04175025224685669, 0.022466957569122314, 0.06581354141235352, 0.017591774463653564, 0.0704261064529419, 0.044014930725097656, 0.035790860652923584, 0.03251868486404419, 0.016016483306884766, 0.05830824375152588, 0.014687955379486084, 0.07361328601837158, 0.06301969289779663, 0.00962918996810913, 0.01403719186782837, 0.03642284870147705, 0.03669571876525879, 0.060977160930633545, 0.03360557556152344, 0.08084458112716675, 0.03768181800842285, 0.05931568145751953, 0.02119457721710205, 0.016507506370544434, 0.049448370933532715, 0.04655939340591431, 0.015248656272888184, 0.02242821455001831, 0.10977578163146973, 0.011449813842773438, 0.02236151695251465, 0.0718390941619873, 0.04448598623275757, 0.008428394794464111, 0.01745837926864624, 0.015726804733276367, 0.014550209045410156, 0.06313979625701904, 0.02729576826095581, 0.0658038854598999, 0.030850112438201904, 0.02594006061553955, 0.05415761470794678, 0.07876986265182495, 0.027031660079956055, 0.0486944317817688, 0.043271541595458984, 0.020337343215942383, 0.03635716438293457, 0.03367692232131958, 0.03994011878967285, 0.05452531576156616, 0.012382686138153076, 0.025777339935302734, 0.02201789617538452, 0.021124064922332764, 0.006050407886505127, 0.05184561014175415, 0.035572350025177, 0.008560121059417725, 0.04172259569168091, 0.0728766918182373, 0.06346404552459717, 0.02098625898361206, 0.014207184314727783, 0.1747293472290039, 0.03221076726913452, 0.03270834684371948, 0.014399945735931396, 0.045003652572631836, 0.023619771003723145, 0.011122345924377441, 0.018633663654327393, 0.011048853397369385, 0.04560518264770508, 0.029923737049102783, 0.054421424865722656, 0.03407180309295654, 0.04944485425949097, 0.1015670895576477, 0.022209346294403076, 0.03487807512283325, 0.045922040939331055, 0.05747544765472412, 0.029839813709259033, 0.05727952718734741, 0.10962939262390137, 0.012483716011047363, 0.0393906831741333, 0.007910668849945068, 0.017020225524902344, 0.00955665111541748, 0.05008429288864136, 0.01313471794128418, 0.02673107385635376, 0.005754709243774414, 0.04205971956253052, 0.043428242206573486, 0.06783360242843628, 0.06857377290725708, 0.020738542079925537, 0.03763967752456665, 0.03874403238296509, 0.04942995309829712, 0.023753762245178223, 0.040416836738586426, 0.045558393001556396, 0.08404570817947388, 0.015032351016998291, 0.01094818115234375, 0.02691030502319336, 0.016096413135528564, 0.028942883014678955, 0.06382554769515991, 0.020951509475708008, 0.022337675094604492, 0.03359431028366089, 0.0389399528503418, 0.031085729598999023, 0.022915184497833252, 0.03097212314605713, 0.009915649890899658, 0.029968619346618652, 0.032756268978118896, 0.01262211799621582, 0.01762491464614868, 0.07685965299606323, 0.0855223536491394, 0.11890697479248047, 0.09634625911712646, 0.01375037431716919, 0.07909208536148071, 0.04503142833709717, 0.03130906820297241, 0.053523898124694824, 0.07258456945419312, 0.03003758192062378, 0.016221821308135986, 0.037961483001708984, 0.012757956981658936, 0.05964052677154541, 0.036448121070861816, 0.038790345191955566, 0.027294039726257324, 0.05727487802505493, 0.0664258599281311, 0.005765974521636963, 0.01946103572845459, 0.03303790092468262, 0.010496377944946289, 0.017756998538970947, 0.048386335372924805, 0.010619819164276123, 0.02135336399078369, 0.015291392803192139, 0.04060971736907959, 0.06608527898788452, 0.019229531288146973, 0.05244719982147217, 0.04563033580780029, 0.0156744122505188, 0.01530390977859497, 0.018571794033050537, 0.013060927391052246, 0.04054558277130127, 0.01799631118774414, 0.025243937969207764, 0.050830185413360596, 0.03191608190536499, 0.026396632194519043, 0.02380305528640747, 0.0068672895431518555, 0.0185396671295166, 0.010349631309509277, 0.04576742649078369, 0.045401692390441895, 0.025459587574005127, 0.021087050437927246, 0.01956796646118164, 0.06402474641799927, 0.05050569772720337, 0.09146934747695923, 0.03011465072631836, 0.035324275493621826, 0.02885490655899048, 0.02303534746170044, 0.024063527584075928, 0.010516166687011719, 0.04072856903076172, 0.13338303565979004, 0.18182969093322754, 0.03620368242263794, 0.0258672833442688, 0.0319591760635376, 0.08756816387176514, 0.01242607831954956, 0.01754581928253174, 0.05617779493331909, 0.07042855024337769, 0.02786087989807129, 0.020121216773986816, 0.03994143009185791, 0.0058249831199646, 0.01547706127166748, 0.043415844440460205, 0.012922823429107666, 0.051520347595214844, 0.02782493829727173, 0.023024141788482666, 0.04091912508010864, 0.02999180555343628, 0.058511197566986084, 0.042702317237854004, 0.04152119159698486, 0.06864553689956665, 0.03755432367324829, 0.028514444828033447, 0.18287932872772217, 0.015893399715423584, 0.012171328067779541, 0.05488866567611694, 0.04765278100967407, 0.09177225828170776, 0.05779421329498291, 0.022591054439544678, 0.04122823476791382, 0.02536541223526001, 0.015065014362335205, 0.053084373474121094, 0.0697246789932251, 0.03172820806503296, 0.01670140027999878, 0.02049154043197632, 0.027035951614379883, 0.03444230556488037, 0.2121877670288086, 0.004822134971618652, 0.011907756328582764, 0.06132173538208008, 0.03086143732070923, 0.026498258113861084, 0.018198728561401367, 0.06463825702667236, 0.05014067888259888, 0.054073870182037354, 0.04184126853942871, 0.04932934045791626, 0.04020267724990845, 0.033157408237457275, 0.04764062166213989, 0.035845816135406494, 0.03704017400741577, 0.028261959552764893, 0.030769765377044678, 0.022502243518829346, 0.09713989496231079, 0.043482422828674316, 0.0811421275138855, 0.02870863676071167, 0.00403982400894165, 0.019810795783996582, 0.017890453338623047, 0.04108816385269165, 0.033214569091796875, 0.06052666902542114, 0.02754300832748413, 0.03601759672164917, 0.05006295442581177, 0.0402911901473999, 0.04510241746902466, 0.02218395471572876, 0.041303396224975586, 0.02988457679748535, 0.016340136528015137, 0.010750651359558105, 0.02204650640487671, 0.03031909465789795, 0.029343247413635254, 0.01574385166168213, 0.0468907356262207, 0.027651071548461914, 0.008624732494354248, 0.04317796230316162, 0.052898108959198, 0.015250861644744873, 0.03202897310256958, 0.04501378536224365, 0.04657870531082153, 0.014085233211517334, 0.01868540048599243, 0.03675663471221924, 0.07062596082687378, 0.012559294700622559, 0.021318793296813965, 0.06786316633224487, 0.04471772909164429, 0.04846489429473877, 0.03264647722244263, 0.026782751083374023, 0.009757637977600098, 0.016444504261016846, 0.04240900278091431, 0.025061309337615967, 0.026278793811798096, 0.06015509366989136, 0.019006729125976562, 0.05697077512741089, 0.042651236057281494, 0.04425525665283203, 0.01301419734954834, 0.010511815547943115, 0.03383570909500122, 0.02279895544052124, 0.01705259084701538, 0.033878326416015625, 0.019157350063323975, 0.036255061626434326, 0.07959944009780884, 0.0406307578086853, 0.03667181730270386, 0.03862643241882324, 0.024392366409301758, 0.016638875007629395, 0.028073012828826904, 0.041708409786224365, 0.028969168663024902, 0.028101027011871338, 0.008262097835540771, 0.02154594659805298, 0.03261423110961914, 0.011745035648345947, 0.08277592062950134, 0.016731321811676025, 0.05641812086105347, 0.08474338054656982, 0.03083646297454834, 0.04320883750915527, 0.04337567090988159, 0.029433012008666992, 0.03938573598861694]
#
# uot_itr=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# uot_mmd=[100, 100, 0.7495251297950745, 0.3416370749473572, 0.38022369146347046, 0.29204699397087097, 0.2674137055873871, 0.1854589879512787, 0.20045500993728638, 0.24400103092193604, 0.22772306203842163, 0.11428767442703247, 0.18728521466255188, 0.29082274436950684, 0.2310389280319214, 0.2077193260192871, 0.34841039776802063, 0.1611325442790985, 0.09032005071640015, 0.21066191792488098, 0.053243786096572876, 0.07489779591560364, 0.019452333450317383, 0.09492087364196777, 0.1653178632259369, 0.11412882804870605, 0.08092564344406128, 0.12443342804908752, 0.05828654766082764, 0.006881773471832275, 0.018727481365203857, 0.051968902349472046, 0.04776334762573242, 0.04081243276596069, 0.018420636653900146, 0.03971230983734131, 0.06470167636871338, 0.04627484083175659, 0.013410389423370361, 0.022493839263916016, 0.0682452917098999, 0.03572756052017212, 0.08226865530014038, 0.09328711032867432, 0.029835879802703857, 0.05860769748687744, 0.05548018217086792, 0.01234138011932373, 0.022475838661193848, 0.09652292728424072, 0.04378575086593628, 0.04359841346740723, 0.05646735429763794, 0.013376474380493164, 0.04010063409805298, 0.12029087543487549, 0.11877775192260742, 0.048092544078826904, 0.028412461280822754, 0.08999770879745483, 0.03493547439575195, 0.013061940670013428, 0.033431291580200195, 0.04885125160217285, 0.046221017837524414, 0.00972527265548706, 0.021946609020233154, 0.023609280586242676, 0.013746857643127441, 0.054025113582611084, 0.04932224750518799, 0.04526644945144653, 0.033281564712524414, 0.04452252388000488, 0.11780720949172974, 0.09100979566574097, 0.01934635639190674, 0.04475224018096924, 0.03547263145446777, 0.15534687042236328, 0.03655731678009033, 0.013888716697692871, 0.010368943214416504, 0.03167217969894409, 0.024763405323028564, 0.08418363332748413, 0.11400449275970459, 0.020047128200531006, 0.009945094585418701, 0.02398359775543213, 0.02335941791534424, 0.013079643249511719, 0.014600634574890137, 0.07361435890197754, 0.09285956621170044, 0.033291399478912354, 0.012684226036071777, 0.02087467908859253, 0.07560372352600098, 0.07566827535629272, 0.014262557029724121, 0.017273545265197754, 0.042557358741760254, 0.05759972333908081, 0.011923253536224365, 0.023750245571136475, 0.009723305702209473, 0.028509140014648438, 0.15614426136016846, 0.04760652780532837, 0.05067974328994751, 0.03622156381607056, 0.024252355098724365, 0.04613834619522095, 0.014739990234375, 0.023190319538116455, 0.0348660945892334, 0.06303244829177856, 0.041501760482788086, 0.0327916145324707, 0.10660099983215332, 0.11080247163772583, 0.034737586975097656, 0.07585591077804565, 0.033376872539520264, 0.07103210687637329, 0.034727394580841064, 0.014685511589050293, 0.027452409267425537, 0.09524434804916382, 0.01798701286315918, 0.05000936985015869, 0.03974568843841553, 0.021304965019226074, 0.033106207847595215, 0.10264068841934204, 0.019666016101837158, 0.020926713943481445, 0.0212860107421875, 0.02180612087249756, 0.012549519538879395, 0.02610105276107788, 0.016866207122802734, 0.02320951223373413, 0.019157111644744873, 0.02502995729446411, 0.03846573829650879, 0.06395399570465088, 0.06385397911071777, 0.04665035009384155, 0.008978605270385742, 0.028305351734161377, 0.020207643508911133, 0.020048141479492188, 0.029016852378845215, 0.02326303720474243, 0.015545785427093506, 0.030119240283966064, 0.021612167358398438, 0.007642686367034912, 0.02406299114227295, 0.023118913173675537, 0.02613168954849243, 0.030042588710784912, 0.014720380306243896, 0.024948835372924805, 0.038552165031433105, 0.038571178913116455, 0.01507800817489624, 0.10771578550338745, 0.023418903350830078, 0.03966033458709717, 0.08754873275756836, 0.008964955806732178, 0.026879310607910156, 0.026000618934631348, 0.062230825424194336, 0.06757992506027222, 0.033381760120391846, 0.02415776252746582, 0.057044148445129395, 0.019605576992034912, 0.040597379207611084, 0.025708138942718506, 0.02078855037689209, 0.05059683322906494, 0.05134075880050659, 0.040851891040802, 0.027482986450195312, 0.024741530418395996, 0.009749114513397217, 0.0370410680770874, 0.08535772562026978, 0.026940882205963135, 0.01894557476043701, 0.031940996646881104, 0.014190375804901123, 0.14500784873962402, 0.04539310932159424, 0.025469601154327393, 0.029143929481506348, 0.04488575458526611, 0.04222846031188965, 0.028463304042816162, 0.01392453908920288, 0.054019391536712646, 0.03490227460861206, 0.03356832265853882, 0.013502061367034912, 0.026329100131988525, 0.06606769561767578, 0.025690793991088867, 0.012674093246459961, 0.028948485851287842, 0.033087849617004395, 0.012029528617858887, 0.04388701915740967, 0.014899194240570068, 0.04156970977783203, 0.00322800874710083, 0.006795704364776611, 0.0518496036529541, 0.025746464729309082, 0.01942235231399536, 0.13498848676681519, 0.09645956754684448, 0.01179438829421997, 0.028573930263519287, 0.027441203594207764, 0.02002882957458496, 0.01701265573501587, 0.01928722858428955, 0.1057012677192688, 0.0670156478881836, 0.024902403354644775, 0.08292698860168457, 0.06687140464782715, 0.0363314151763916, 0.0640186071395874, 0.05321604013442993, 0.019709229469299316, 0.023434698581695557, 0.03982400894165039, 0.14229798316955566, 0.05378073453903198, 0.03965437412261963, 0.026230990886688232, 0.06972277164459229, 0.01859647035598755, 0.031683146953582764, 0.08465385437011719, 0.0803900957107544, 0.07593727111816406, 0.1272803544998169, 0.03903883695602417, 0.014925658702850342, 0.044446468353271484, 0.01431185007095337, 0.01732051372528076, 0.050773561000823975, 0.1166454553604126, 0.05744755268096924, 0.06979566812515259, 0.015380263328552246, 0.056093454360961914, 0.008756399154663086, 0.09127688407897949, 0.002228379249572754, 0.01896458864212036, 0.033193349838256836, 0.02287191152572632, 0.0767098069190979, 0.06261700391769409, 0.029579102993011475, 0.0077555179595947266, 0.020280003547668457, 0.06053417921066284, 0.05161815881729126, 0.01701676845550537, 0.024260997772216797, 0.021959662437438965, 0.06317120790481567, 0.013868749141693115, 0.03547865152359009, 0.08821481466293335, 0.03244888782501221, 0.012491822242736816, 0.01711052656173706, 0.0339626669883728, 0.015637576580047607, 0.03082352876663208, 0.01784837245941162, 0.03859621286392212, 0.021948516368865967, 0.09781819581985474, 0.030625343322753906, 0.05312800407409668, 0.005914270877838135, 0.01064455509185791, 0.015397846698760986, 0.022951841354370117, 0.016740739345550537, 0.09020489454269409, 0.0615805983543396, 0.0788612961769104, 0.023781239986419678, 0.04047888517379761, 0.026374340057373047, 0.042500436305999756, 0.022253811359405518, 0.011128842830657959, 0.01126408576965332, 0.04770785570144653, 0.029414594173431396, 0.03210347890853882, 0.042996108531951904, 0.043243348598480225, 0.03628230094909668, 0.08443385362625122, 0.01797962188720703, 0.03719067573547363, 0.01335996389389038, 0.07839047908782959, 0.036189377307891846, 0.02097153663635254, 0.03531825542449951, 0.06183534860610962, 0.011864960193634033, 0.05845588445663452, 0.06390869617462158, 0.056704819202423096, 0.05016988515853882, 0.05265134572982788, 0.05468469858169556, 0.05979126691818237, 0.05217617750167847, 0.009194910526275635, 0.07304525375366211, 0.04074060916900635, 0.014573276042938232, 0.07326173782348633, 0.14146727323532104, 0.09191793203353882, 0.027650773525238037, 0.011568129062652588, 0.023582637310028076, 0.03261065483093262, 0.010401129722595215, 0.06747674942016602, 0.06625902652740479, 0.04337465763092041, 0.02636873722076416, 0.025508999824523926, 0.024682223796844482, 0.02797985076904297, 0.06154364347457886, 0.042432427406311035, 0.035356998443603516, 0.01350092887878418, 0.0196266770362854, 0.036225318908691406, 0.020259499549865723, 0.057369232177734375, 0.03678572177886963, 0.02390158176422119, 0.03187066316604614, 0.012767970561981201, 0.01359403133392334, 0.03877902030944824, 0.030800223350524902, 0.01142948865890503, 0.07526445388793945, 0.04687774181365967, 0.04757815599441528, 0.050087809562683105, 0.048271894454956055, 0.021361231803894043, 0.08648371696472168, 0.03699779510498047, 0.035211145877838135, 0.035848140716552734, 0.029906034469604492, 0.0364072322845459, 0.022092461585998535, 0.01530909538269043, 0.04162055253982544, 0.024528861045837402, 0.08786952495574951, 0.009736895561218262, 0.04011118412017822, 0.07616370916366577, 0.016821324825286865, 0.0182839035987854, 0.10385632514953613, 0.027482688426971436, 0.04070162773132324, 0.048557937145233154, 0.0193672776222229, 0.05384215712547302, 0.02097219228744507, 0.01634979248046875, 0.02096480131149292, 0.041061341762542725, 0.014067351818084717, 0.06043374538421631, 0.013119995594024658, 0.01159435510635376, 0.013796687126159668, 0.025820672512054443, 0.06231820583343506, 0.03940534591674805, 0.02291041612625122, 0.03447180986404419, 0.03261512517929077, 0.020642399787902832, 0.049707889556884766, 0.041140735149383545, 0.031014561653137207, 0.008031189441680908, 0.01744157075881958, 0.011858940124511719, 0.049346983432769775, 0.05426675081253052, 0.008462131023406982, 0.06327259540557861, 0.06384152173995972, 0.009111225605010986, 0.03965866565704346, 0.051731765270233154, 0.02901524305343628, 0.02209782600402832, 0.02820509672164917, 0.028925538063049316, 0.006008565425872803, 0.038127243518829346, 0.045557260513305664, 0.02560657262802124, 0.01685994863510132, 0.03855210542678833, 0.011381387710571289, 0.025067269802093506, 0.06681662797927856, 0.06112933158874512, 0.039828360080718994, 0.04290708899497986, 0.024393737316131592, 0.026375770568847656, 0.010032176971435547, 0.01862037181854248, 0.03486776351928711, 0.046539247035980225, 0.02591395378112793, 0.021226227283477783, 0.06255179643630981, 0.06083160638809204, 0.06328463554382324, 0.04429095983505249, 0.06945794820785522, 0.03570681810379028, 0.039870500564575195, 0.029136061668395996, 0.017918884754180908, 0.021280646324157715, 0.026686131954193115, 0.14109468460083008, 0.01544278860092163, 0.06789290904998779, 0.07928705215454102, 0.04071664810180664, 0.03603845834732056, 0.016652405261993408, 0.07970184087753296, 0.07796967029571533, 0.06555986404418945, 0.02123093605041504, 0.017049193382263184, 0.02575141191482544, 0.04599118232727051, 0.029213428497314453, 0.02102029323577881, 0.030215561389923096, 0.09508931636810303, 0.06450271606445312, 0.013543784618377686, 0.01685488224029541, 0.010954439640045166, 0.03262048959732056, 0.04942053556442261, 0.051790833473205566, 0.02948838472366333, 0.03730887174606323, 0.0215035080909729, 0.02690863609313965, 0.013686299324035645, 0.009740769863128662, 0.037996768951416016, 0.005077540874481201, 0.03719615936279297, 0.04167729616165161, 0.007783949375152588]
# t=20
# plt.plot(ot_itr[t:], ot_mmd[t:], label="OT")
# plt.plot(uot_itr[t:], uot_mmd[t:], label="UOT")
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.title('Trainging samples:{}, Test samples:{}, fixed sample'.format(2000,20))
# plt.legend()
# plt.show()

# t=20
# plt.plot(ot_itr[t:], ot_mmd[t:], label="OT")
# plt.plot(uot_itr[t:], uot_mmd[t:], label="UOT")
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.title('Trainging samples:{}, Test samples:{}, fixed sample'.format(1000,20))
# plt.legend()
# plt.show()


# ot_itr=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# ot_mmd=[0.43942490220069885, 0.25859522819519043, 0.3915376663208008, 0.3579240143299103, 0.14537712931632996, 0.3637067973613739, 0.5474147200584412, 0.34303683042526245, 0.34418773651123047, 0.10175371170043945, 0.1837054193019867, 0.24382001161575317, 0.112343430519104, 0.05448192358016968, 0.056639909744262695, 0.0328136682510376, 0.09489434957504272, 0.10164445638656616, 0.05499058961868286, 0.06676548719406128, 0.06240123510360718, 0.04438239336013794, 0.04860776662826538, 0.08764973282814026, 0.03981214761734009, 0.07015079259872437, 0.07888567447662354, 0.02640479803085327, 0.123435378074646, 0.10255235433578491, 0.04112732410430908, 0.13181352615356445, 0.018167436122894287, 0.024284541606903076, 0.019163787364959717, 0.11688366532325745, 0.019446253776550293, 0.01633632183074951, 0.1214897632598877, 0.031837522983551025, 0.041559576988220215, 0.0373271107673645, 0.01457226276397705, 0.05081397294998169, 0.015484929084777832, 0.045646846294403076, 0.00923299789428711, 0.020179688930511475, 0.016364455223083496, 0.027792274951934814, 0.04370427131652832, 0.03988444805145264, 0.07840561866760254, 0.12770575284957886, 0.042977333068847656, 0.014246106147766113, 0.013987481594085693, 0.033959269523620605, 0.056914329528808594, 0.023145854473114014, 0.01589798927307129, 0.03498399257659912, 0.07675677537918091, 0.10258686542510986, 0.012317895889282227, 0.018314242362976074, 0.01616734266281128, 0.015737712383270264, 0.0568808913230896, 0.009789466857910156, 0.05079299211502075, 0.03341609239578247, 0.08441334962844849, 0.022730886936187744, 0.025746405124664307, 0.00958186388015747, 0.022182703018188477, 0.07192438840866089, 0.03351491689682007, 0.013344407081604004, 0.020331859588623047, 0.022144079208374023, 0.018796265125274658, 0.03719097375869751, 0.010385870933532715, 0.07584649324417114, 0.031552255153656006, 0.03498274087905884, 0.021203160285949707, 0.006724238395690918, 0.02885913848876953, 0.08042556047439575, 0.015544235706329346, 0.04316830635070801, 0.01488882303237915, 0.04985922574996948, 0.024870634078979492, 0.042133212089538574, 0.028847217559814453, 0.043224453926086426, 0.023678898811340332, 0.03438436985015869, 0.08240330219268799, 0.057351112365722656, 0.07219147682189941, 0.03976541757583618, 0.034687340259552, 0.1124190092086792, 0.041061341762542725, 0.019044339656829834, 0.04545789957046509, 0.011539101600646973, 0.023450076580047607, 0.05749267339706421, 0.03243565559387207, 0.04629582166671753, 0.03821969032287598, 0.012525796890258789, 0.01715075969696045, 0.011995196342468262, 0.007600188255310059, 0.005542576313018799, 0.06262749433517456, 0.005216658115386963, 0.044364750385284424, 0.01837289333343506, 0.02654135227203369, 0.021395862102508545, 0.010635077953338623, 0.01991027593612671, 0.06159776449203491, 0.030190229415893555, 0.02641451358795166, 0.05125802755355835, 0.07232624292373657, 0.032052695751190186, 0.08035653829574585, 0.032520413398742676, 0.03795051574707031, 0.024466872215270996, 0.027253389358520508, 0.014556646347045898, 0.03217947483062744, 0.07961499691009521, 0.017413020133972168, 0.009892642498016357, 0.029376208782196045, 0.015579581260681152, 0.04285919666290283, 0.01508629322052002, 0.01753753423690796, 0.010029494762420654, 0.00979691743850708, 0.02310103178024292, 0.04629111289978027, 0.03256005048751831, 0.03175288438796997, 0.017080247402191162, 0.03709501028060913, 0.02630794048309326, 0.02220308780670166, 0.0428013801574707, 0.062248826026916504, 0.0397491455078125, 0.053687214851379395, 0.03258037567138672, 0.04519432783126831, 0.022082626819610596, 0.03478288650512695, 0.02713567018508911, 0.04646092653274536, 0.01602017879486084, 0.0589599609375, 0.03600144386291504, 0.026613712310791016, 0.06467771530151367, 0.0215303897857666, 0.020624279975891113, 0.011287510395050049, 0.027842581272125244, 0.01774775981903076, 0.021898329257965088, 0.010644733905792236, 0.024860262870788574, 0.03234618902206421, 0.01093447208404541, 0.010188877582550049, 0.04517078399658203, 0.041041791439056396, 0.01857084035873413, 0.00973731279373169, 0.04073983430862427, 0.02331864833831787, 0.03848147392272949, 0.01832139492034912, 0.06936848163604736, 0.024462580680847168, 0.02652263641357422, 0.014921605587005615, 0.04381662607192993, 0.09481683373451233, 0.08870559930801392, 0.034650206565856934, 0.01376110315322876, 0.027288079261779785, 0.02234792709350586, 0.031344830989837646, 0.03293222188949585, 0.023686885833740234, 0.0131758451461792, 0.07993865013122559, 0.018283367156982422, 0.01964867115020752, 0.03203099966049194, 0.03814435005187988, 0.02305525541305542, 0.022893011569976807, 0.04033398628234863, 0.01908397674560547, 0.026013553142547607, 0.01408618688583374, 0.02992922067642212, 0.03712284564971924, 0.03445637226104736, 0.018065273761749268, 0.010430574417114258, 0.10919040441513062, 0.03363138437271118, 0.011503875255584717, 0.06241720914840698, 0.06748932600021362, 0.008749604225158691, 0.028177976608276367, 0.026298463344573975, 0.018730878829956055, 0.03334665298461914, 0.00793600082397461, 0.030273914337158203, 0.016708314418792725, 0.009586453437805176, 0.012576162815093994, 0.06687957048416138, 0.039791643619537354, 0.022734224796295166, 0.06414574384689331, 0.03349405527114868, 0.08481788635253906, 0.05871206521987915, 0.013025939464569092, 0.026517868041992188, 0.04361933469772339, 0.0268404483795166, 0.021424055099487305, 0.015641450881958008, 0.07333868741989136, 0.025601506233215332, 0.019688963890075684, 0.03663820028305054, 0.032938599586486816, 0.05307573080062866, 0.019816279411315918, 0.07985931634902954, 0.025973200798034668, 0.024743735790252686, 0.015783309936523438, 0.03431355953216553, 0.026106655597686768, 0.04866945743560791, 0.041171491146087646, 0.08002179861068726, 0.05391746759414673, 0.08822676539421082, 0.10667353868484497, 0.0367581844329834, 0.06874668598175049, 0.020125746726989746, 0.05084484815597534, 0.0297701358795166, 0.04280543327331543, 0.016395986080169678, 0.04537320137023926, 0.015597999095916748, 0.03407430648803711, 0.02148526906967163, 0.03500300645828247, 0.023413538932800293, 0.022569775581359863, 0.029402971267700195, 0.01932549476623535, 0.05106806755065918, 0.017534852027893066, 0.012113213539123535, 0.024242043495178223, 0.06889522075653076, 0.027834713459014893, 0.029168307781219482, 0.029524624347686768, 0.016622722148895264, 0.02329307794570923, 0.038804054260253906, 0.02771550416946411, 0.011166632175445557, 0.009298443794250488, 0.017519831657409668, 0.02981412410736084, 0.0751875638961792, 0.02136516571044922, 0.00774228572845459, 0.03127545118331909, 0.04310333728790283, 0.024671614170074463, 0.04586291313171387, 0.03102397918701172, 0.018878459930419922, 0.02923417091369629, 0.007140398025512695, 0.017144203186035156, 0.015308141708374023, 0.05279064178466797, 0.01972752809524536, 0.021703720092773438, 0.02400517463684082, 0.009432494640350342, 0.04339677095413208, 0.016055762767791748, 0.05762970447540283, 0.009216666221618652, 0.04648333787918091, 0.055313169956207275, 0.03721052408218384, 0.06936204433441162, 0.040780842304229736, 0.022367894649505615, 0.02255302667617798, 0.020819127559661865, 0.037008702754974365, 0.13632935285568237, 0.01305246353149414, 0.016204416751861572, 0.019975006580352783, 0.05548560619354248, 0.10850471258163452, 0.054198503494262695, 0.02832692861557007, 0.010622799396514893, 0.06748563051223755, 0.01487666368484497, 0.013715088367462158, 0.03865396976470947, 0.021699607372283936, 0.06299936771392822, 0.04973858594894409, 0.016919851303100586, 0.08186185359954834, 0.013222992420196533, 0.022134721279144287, 0.03172332048416138, 0.030807971954345703, 0.02457582950592041, 0.02518486976623535, 0.05894678831100464, 0.023164868354797363, 0.024220585823059082, 0.007516980171203613, 0.016957402229309082, 0.04098522663116455, 0.07023096084594727, 0.049439430236816406, 0.034004390239715576, 0.06288790702819824, 0.024885118007659912, 0.032529473304748535, 0.06388038396835327, 0.015848278999328613, 0.0035727620124816895, 0.06344550848007202, 0.02226424217224121, 0.032119810581207275, 0.016619384288787842, 0.04570430517196655, 0.019799649715423584, 0.023707449436187744, 0.009097874164581299, 0.02716594934463501, 0.042878568172454834, 0.018731117248535156, 0.01868957281112671, 0.017303645610809326, 0.0667886734008789, 0.03646057844161987, 0.00880807638168335, 0.010914742946624756, 0.01626873016357422, 0.03965634107589722, 0.04398089647293091, 0.059369027614593506, 0.033659160137176514, 0.09311872720718384, 0.013076722621917725, 0.036761701107025146, 0.03010725975036621, 0.023883581161499023, 0.032295286655426025, 0.013843059539794922, 0.019760608673095703, 0.020088553428649902, 0.020093679428100586, 0.024736523628234863, 0.013671040534973145, 0.029554545879364014, 0.02473926544189453, 0.04596292972564697, 0.041042864322662354, 0.01916825771331787, 0.008294761180877686, 0.04159736633300781, 0.05741596221923828, 0.029395759105682373, 0.06471860408782959, 0.005720794200897217, 0.02114272117614746, 0.013849496841430664, 0.03821760416030884, 0.02015507221221924, 0.04799842834472656, 0.02461320161819458, 0.03227287530899048, 0.10326892137527466, 0.03299528360366821, 0.05412477254867554, 0.028532028198242188, 0.01707017421722412, 0.011833250522613525, 0.04221022129058838, 0.022629261016845703, 0.03304833173751831, 0.013846755027770996, 0.05595749616622925, 0.02503979206085205, 0.021660208702087402, 0.042872846126556396, 0.03853893280029297, 0.03980052471160889, 0.015101850032806396, 0.05579942464828491, 0.012578725814819336, 0.040336012840270996, 0.05927133560180664, 0.02069556713104248, 0.017037928104400635, 0.011692643165588379, 0.04420578479766846, 0.03948974609375, 0.03734666109085083, 0.06394439935684204, 0.061769306659698486, 0.039903223514556885, 0.04108119010925293, 0.017513036727905273, 0.012481331825256348, 0.02329730987548828, 0.015807926654815674, 0.024893522262573242, 0.04760855436325073, 0.04165387153625488, 0.04807955026626587, 0.05902266502380371, 0.03761774301528931, 0.052516043186187744, 0.054397523403167725, 0.026069819927215576, 0.029050111770629883, 0.10799366235733032, 0.04552745819091797, 0.03619647026062012, 0.030570685863494873, 0.053569138050079346, 0.008226871490478516, 0.0461808443069458, 0.011402785778045654, 0.033438682556152344, 0.0361480712890625, 0.01382511854171753, 0.02603912353515625, 0.044903695583343506, 0.027217388153076172, 0.01692485809326172, 0.028784453868865967, 0.03867238759994507, 0.01820826530456543, 0.05403405427932739, 0.02663332223892212, 0.04290896654129028, 0.028422415256500244, 0.05252337455749512, 0.033120691776275635, 0.003494560718536377, 0.01651287078857422, 0.03836911916732788, 0.036460161209106445]
# uot_itr=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500]
# uot_mmd=[1.1836161068630016e+16, 0.691799521446228, 0.2929438352584839, 0.5214951038360596, 0.10137486457824707, 0.12376141548156738, 0.4376927614212036, 0.6209291219711304, 0.4832514822483063, 0.3337711691856384, 0.2125319242477417, 0.15039953589439392, 0.2084938883781433, 0.23941558599472046, 0.3536159098148346, 0.20002111792564392, 0.21642491221427917, 0.1934012770652771, 0.10181924700737, 0.12967804074287415, 0.13744500279426575, 0.09406614303588867, 0.11559829115867615, 0.17586010694503784, 0.10900729894638062, 0.05315756797790527, 0.04293638467788696, 0.052609801292419434, 0.08896934986114502, 0.0572124719619751, 0.06762087345123291, 0.050142496824264526, 0.03258270025253296, 0.08520400524139404, 0.05703657865524292, 0.08350640535354614, 0.017158567905426025, 0.0307234525680542, 0.04347294569015503, 0.044429779052734375, 0.04022824764251709, 0.22901231050491333, 0.0311468243598938, 0.03014051914215088, 0.043843865394592285, 0.018519282341003418, 0.02632761001586914, 0.08602899312973022, 0.04998117685317993, 0.051569998264312744, 0.0586167573928833, 0.08497273921966553, 0.03308844566345215, 0.015974581241607666, 0.021678507328033447, 0.05940389633178711, 0.027818918228149414, 0.0666189193725586, 0.045039355754852295, 0.030253350734710693, 0.027559936046600342, 0.09720039367675781, 0.04069066047668457, 0.02863246202468872, 0.02539271116256714, 0.030523300170898438, 0.0804131031036377, 0.02721768617630005, 0.03737175464630127, 0.04948318004608154, 0.05114030838012695, 0.011964142322540283, 0.019934654235839844, 0.02286851406097412, 0.014700889587402344, 0.02434718608856201, 0.046307146549224854, 0.0172232985496521, 0.025721728801727295, 0.01888728141784668, 0.11519879102706909, 0.08333438634872437, 0.04628551006317139, 0.12369078397750854, 0.08823585510253906, 0.13707870244979858, 0.06513357162475586, 0.036033570766448975, 0.11313718557357788, 0.055174052715301514, 0.016704320907592773, 0.06736141443252563, 0.06046873331069946, 0.020161569118499756, 0.024731695652008057, 0.10428440570831299, 0.03141045570373535, 0.017679810523986816, 0.06915128231048584, 0.03336203098297119, 0.034090280532836914, 0.06457680463790894, 0.03237950801849365, 0.05135148763656616, 0.03346908092498779, 0.008684873580932617, 0.025866031646728516, 0.025464951992034912, 0.0442502498626709, 0.03927254676818848, 0.11931782960891724, 0.019236385822296143, 0.02542269229888916, 0.047367215156555176, 0.023766398429870605, 0.026702821254730225, 0.0190618634223938, 0.04174387454986572, 0.024761199951171875, 0.03270447254180908, 0.05338728427886963, 0.11602538824081421, 0.05192708969116211, 0.022627949714660645, 0.06780463457107544, 0.028567492961883545, 0.027788102626800537, 0.03966021537780762, 0.029222548007965088, 0.02987837791442871, 0.034865617752075195, 0.041341304779052734, 0.02417612075805664, 0.016373276710510254, 0.05667656660079956, 0.013236820697784424, 0.0217742919921875, 0.048393845558166504, 0.025379180908203125, 0.052609026432037354, 0.09814798831939697, 0.03388679027557373, 0.2499082088470459, 0.1488354206085205, 0.08944714069366455, 0.017898738384246826, 0.033499300479888916, 0.005601227283477783, 0.03536587953567505, 0.04089480638504028, 0.05571502447128296, 0.018274366855621338, 0.04850822687149048, 0.0247727632522583, 0.07062709331512451, 0.03377664089202881, 0.16035586595535278, 0.012323141098022461, 0.024475455284118652, 0.028059422969818115, 0.042942166328430176, 0.014708399772644043, 0.020427703857421875, 0.009356141090393066, 0.03952360153198242, 0.021252751350402832, 0.03392082452774048, 0.025693237781524658, 0.09890973567962646, 0.09744846820831299, 0.029199302196502686, 0.030911147594451904, 0.02349269390106201, 0.012849509716033936, 0.012166798114776611, 0.02039802074432373, 0.0261380672454834, 0.02335214614868164, 0.01918560266494751, 0.02657264471054077, 0.032427966594696045, 0.028428852558135986, 0.046842098236083984, 0.01857680082321167, 0.00836324691772461, 0.036670565605163574, 0.12790513038635254, 0.012452661991119385, 0.05334824323654175, 0.03751063346862793, 0.0239793062210083, 0.026733756065368652, 0.03493213653564453, 0.08853435516357422, 0.016323089599609375, 0.008011341094970703, 0.04833114147186279, 0.1922181248664856, 0.035923779010772705, 0.02118849754333496, 0.017317116260528564, 0.012222647666931152, 0.0600396990776062, 0.10191601514816284, 0.029741764068603516, 0.017571747303009033, 0.06057864427566528, 0.02965456247329712, 0.028382956981658936, 0.0835493803024292, 0.0406307578086853, 0.03917992115020752, 0.022401273250579834, 0.013515949249267578, 0.08121055364608765, 0.044472336769104004, 0.0606226921081543, 0.022513747215270996, 0.02769148349761963, 0.04866147041320801, 0.09154093265533447, 0.023577332496643066, 0.031623899936676025, 0.0320928692817688, 0.031438469886779785, 0.063648521900177, 0.022911250591278076, 0.048682451248168945, 0.025845587253570557, 0.05221116542816162, 0.04056715965270996, 0.027466177940368652, 0.006776630878448486, 0.0478023886680603, 0.05412870645523071, 0.007414281368255615, 0.05440676212310791, 0.06858944892883301, 0.0696142315864563, 0.05097073316574097, 0.01938319206237793, 0.06662923097610474, 0.03801620006561279, 0.0347633957862854, 0.014259040355682373, 0.02942126989364624, 0.053938210010528564, 0.05425220727920532, 0.02251344919204712, 0.021968424320220947, 0.04663962125778198, 0.029330968856811523, 0.03864312171936035, 0.05592399835586548, 0.01361393928527832, 0.04895329475402832, 0.029591858386993408, 0.027152061462402344, 0.06770855188369751, 0.027348995208740234, 0.0033780336380004883, 0.01671457290649414, 0.046551644802093506, 0.012926220893859863, 0.01633298397064209, 0.0503728985786438, 0.036173224449157715, 0.03279829025268555, 0.01920384168624878, 0.013627827167510986, 0.0061421990394592285, 0.04070323705673218, 0.010881006717681885, 0.0028939247131347656, 0.02383488416671753, 0.07203561067581177, 0.026807188987731934, 0.0512428879737854, 0.043756842613220215, 0.0328747034072876, 0.008043467998504639, 0.008418858051300049, 0.0437542200088501, 0.026445329189300537, 0.0394974946975708, 0.027321219444274902, 0.018991053104400635, 0.04823577404022217, 0.006874382495880127, 0.0073400139808654785, 0.04195159673690796, 0.013040602207183838, 0.03565812110900879, 0.05114090442657471, 0.022635698318481445, 0.05600309371948242, 0.03274250030517578, 0.07242012023925781, 0.02090156078338623, 0.04579043388366699, 0.04018735885620117, 0.013410806655883789, 0.0644768476486206, 0.028006553649902344, 0.11468535661697388, 0.045293331146240234, 0.009832322597503662, 0.03520601987838745, 0.02778083086013794, 0.020121753215789795, 0.018540680408477783, 0.021675467491149902, 0.02983182668685913, 0.019404172897338867, 0.04271036386489868, 0.02402961254119873, 0.030198752880096436, 0.029026031494140625, 0.012952864170074463, 0.014246821403503418, 0.01776939630508423, 0.07662725448608398, 0.0271303653717041, 0.012493491172790527, 0.05537915229797363, 0.04448741674423218, 0.026231467723846436, 0.024090826511383057, 0.03943675756454468, 0.01522970199584961, 0.06003701686859131, 0.04154479503631592, 0.07805466651916504, 0.0321965217590332, 0.037750959396362305, 0.03375387191772461, 0.02055114507675171, 0.017594218254089355, 0.03059208393096924, 0.050762295722961426, 0.013141989707946777, 0.020788371562957764, 0.04567140340805054, 0.03185945749282837, 0.07970517873764038, 0.06438547372817993, 0.043089210987091064, 0.021969199180603027, 0.03483098745346069, 0.04406255483627319, 0.03278297185897827, 0.01708197593688965, 0.04065203666687012, 0.08075135946273804, 0.07520866394042969, 0.010023534297943115, 0.07473784685134888, 0.0067629218101501465, 0.032049715518951416, 0.022087574005126953, 0.013267695903778076, 0.08104395866394043, 0.03866833448410034, 0.026652276515960693, 0.04093623161315918, 0.13593655824661255, 0.025246500968933105, 0.04534947872161865, 0.011289656162261963, 0.0413472056388855, 0.02226155996322632, 0.04406440258026123, 0.011202216148376465, 0.004442453384399414, 0.035807907581329346, 0.01219719648361206, 0.027355968952178955, 0.03321802616119385, 0.021944046020507812, 0.06568706035614014, 0.10684770345687866, 0.08781605958938599, 0.034767329692840576, 0.008008182048797607, 0.11090147495269775, 0.053526103496551514, 0.025816917419433594, 0.027311384677886963, 0.03205573558807373, 0.06064814329147339, 0.029066503047943115, 0.04834449291229248, 0.08522951602935791, 0.017565429210662842, 0.03381025791168213, 0.014570415019989014, 0.035591304302215576, 0.0269128680229187, 0.011576056480407715, 0.02337592840194702, 0.039641380310058594, 0.02032679319381714, 0.003690063953399658, 0.0225217342376709, 0.009708285331726074, 0.04825699329376221, 0.009005844593048096, 0.028379499912261963, 0.011417865753173828, 0.01508718729019165, 0.06233799457550049, 0.018624305725097656, 0.040081799030303955, 0.025285780429840088, 0.052389442920684814, 0.013425588607788086, 0.01318669319152832, 0.04209339618682861, 0.043416619300842285, 0.05513948202133179, 0.03363829851150513, 0.019540846347808838, 0.031879425048828125, 0.025313198566436768, 0.010595321655273438, 0.07162803411483765, 0.021351218223571777, 0.017150044441223145, 0.0223274827003479, 0.09038209915161133, 0.02655082941055298, 0.03626435995101929, 0.04259133338928223, 0.012188374996185303, 0.01202857494354248, 0.01528012752532959, 0.04339027404785156, 0.024576008319854736, 0.009412705898284912, 0.06507116556167603, 0.03881961107254028, 0.010371387004852295, 0.06272310018539429, 0.02686077356338501, 0.06246751546859741, 0.04029661417007446, 0.019093215465545654, 0.013712763786315918, 0.025555551052093506, 0.0160483717918396, 0.013303518295288086, 0.03242838382720947, 0.022700846195220947, 0.04074913263320923, 0.029212892055511475, 0.02576148509979248, 0.05170506238937378, 0.0761825442314148, 0.025137484073638916, 0.04150205850601196, 0.13735049962997437, 0.03486746549606323, 0.05000823736190796, 0.05039370059967041, 0.04367798566818237, 0.04287189245223999, 0.04183703660964966, 0.02293682098388672, 0.011706233024597168, 0.03287237882614136, 0.04675555229187012, 0.014634788036346436, 0.010921359062194824, 0.07188063859939575, 0.07175302505493164, 0.033684492111206055, 0.01731199026107788, 0.04593825340270996, 0.024110138416290283, 0.022124648094177246, 0.020522892475128174, 0.018238604068756104, 0.024629175662994385, 0.11066710948944092, 0.01420527696609497, 0.013789534568786621, 0.04965430498123169, 0.05494731664657593, 0.03767037391662598, 0.02054983377456665, 0.06561368703842163, 0.011728346347808838, 0.028927743434906006, 0.021209537982940674, 0.04384642839431763, 0.01563781499862671, 0.02572256326675415, 0.028812885284423828, 0.021242856979370117, 0.03875851631164551]

# plt.plot(ot_itr[t:], ot_mmd[t:], label="OT")
# plt.plot(uot_itr[t:], uot_mmd[t:], label="UOT")
# plt.xlabel('Iteration')
# plt.ylabel('MMD')
# plt.title('Trainging samples:{}, Test samples:{}'.format(1000,20))
# plt.legend()
# plt.show()

# 4000,4000
ot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
ot_mmd=[0.1569414734840393, 0.07957598567008972, 0.008282124996185303, 0.009931683540344238, 0.006635785102844238, 0.004403948783874512, 0.002064049243927002, 0.0009278059005737305, 0.0003838539123535156, 0.0005187392234802246, 0.0005172491073608398, 0.0009273886680603027, 0.0005055069923400879, 0.00021272897720336914, 0.00018614530563354492, 0.00020742416381835938, 0.00025016069412231445, 0.0004608035087585449, 0.0010925531387329102, 0.0007113814353942871, 0.0006577372550964355, 0.00034755468368530273, 0.0012627840042114258, 0.0007259249687194824, 0.0006709694862365723, 0.0003466010093688965, 0.000707089900970459, 0.0005946755409240723, 0.0008887052536010742, 0.0004687309265136719, 0.0009537935256958008, 0.0006653070449829102, 0.0008646249771118164, 0.00039374828338623047, 0.00021141767501831055, 0.0002993941307067871, 0.0002484917640686035, 0.0002453923225402832, 0.0004534721374511719, 0.0002690553665161133, 0.0002086162567138672, 0.0010151863098144531, 0.0001232624053955078, 0.00024574995040893555, 0.0007361769676208496, 0.00017189979553222656, 0.0002499222755432129, 0.00013381242752075195, 0.0005715489387512207, 0.001117408275604248]
uot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
uot_mmd=[0.13047641515731812, 0.010164260864257812, 0.01537775993347168, 0.005601346492767334, 0.0064040422439575195, 0.0012366175651550293, 0.0008074641227722168, 0.006100118160247803, 0.002300739288330078, 0.001983046531677246, 0.00045371055603027344, 0.0011054277420043945, 0.0016005635261535645, 0.00025641918182373047, 0.0011182427406311035, 0.0010606646537780762, 0.00035077333450317383, 0.0007447004318237305, 0.0008724331855773926, 0.0005965232849121094, 0.00010538101196289062, 0.0002943873405456543, 0.0008586645126342773, 0.0003191232681274414, 0.0008218884468078613, 0.0008844137191772461, 0.0003553628921508789, 0.0010402798652648926, 0.0007711052894592285, 0.0012248754501342773, 0.0002625584602355957, 0.00036787986755371094, 0.0013693571090698242, 0.00029963254928588867, 0.0002060532569885254, 0.0004374384880065918, 0.00037670135498046875, 0.0009040236473083496, 0.00046074390411376953, 0.0004411935806274414, 0.00046324729919433594, 0.00018280744552612305, 0.0006226301193237305, 0.0016657710075378418, 0.0006797313690185547, 0.0003147721290588379, 0.0007538795471191406, 0.00036972761154174805, 0.0001583695411682129, 7.56382942199707e-05]

t=5
plt.plot(ot_itr[t:], ot_mmd[t:], label="OT")
plt.plot(uot_itr[t:], uot_mmd[t:], label="UOT")
plt.xlabel('Iteration')
plt.ylabel('MMD')
plt.title('Trainging samples:{}, Test samples:{}'.format(4000, 4000))
plt.legend()
plt.show()

# 100,4000
ot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
ot_mmd=[0.14542892575263977, 0.08065396547317505, 0.012190163135528564, 0.008508086204528809, 0.0045948028564453125, 0.036505043506622314, 0.02980029582977295, 0.018916606903076172, 0.011777877807617188, 0.016272544860839844, 0.0037459135055541992, 0.007501006126403809, 0.0129547119140625, 0.017727136611938477, 0.020398974418640137, 0.028339385986328125, 0.03782743215560913, 0.021333158016204834, 0.01721024513244629, 0.018619000911712646, 0.005376219749450684, 0.0018224716186523438, 0.01099008321762085, 0.035477638244628906, 0.02417445182800293, 0.02846890687942505, 0.04359996318817139, 0.04076850414276123, 0.02151966094970703, 0.016125142574310303, 0.019870340824127197, 0.019961416721343994, 0.027912557125091553, 0.029420554637908936, 0.022179067134857178, 0.01819664239883423, 0.013682425022125244, 0.0064580440521240234, 0.016788244247436523, 0.014114141464233398, 0.009177684783935547, 0.012468695640563965, 0.026636242866516113, 0.017591357231140137, 0.01651585102081299, 0.019367754459381104, 0.013984382152557373, 0.022935450077056885, 0.011963963508605957, 0.016395926475524902]
uot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
uot_mmd=[0.28987324237823486, 0.03759044408798218, 0.028976857662200928, 0.006023228168487549, 0.015793919563293457, 0.0147133469581604, 0.011271834373474121, 0.012449562549591064, 0.01659989356994629, 0.013601362705230713, 0.014651000499725342, 0.02483820915222168, 0.0053517818450927734, 0.008596539497375488, 0.007448554039001465, 0.030517756938934326, 0.02075129747390747, 0.03682148456573486, 0.02104318141937256, 0.015443742275238037, 0.014392197132110596, 0.015387773513793945, 0.008855462074279785, 0.009141027927398682, 0.011945486068725586, 0.008218169212341309, 0.004273593425750732, 0.015322268009185791, 0.020566344261169434, 0.035511136054992676, 0.009462416172027588, 0.007119476795196533, 0.01899629831314087, 0.008351147174835205, 0.007406651973724365, 0.03117138147354126, 0.015067994594573975, 0.014032602310180664, 0.02019721269607544, 0.016355812549591064, 0.02185380458831787, 0.025861501693725586, 0.018277764320373535, 0.02753615379333496, 0.02778083086013794, 0.03448516130447388, 0.01028352975845337, 0.03036874532699585, 0.027100682258605957, 0.027872562408447266]

# ot_mmd = np.log(np.array(ot_mmd))
# uot_mmd = np.log(np.array(uot_mmd))

t=5
plt.plot(ot_itr[t:], ot_mmd[t:], label="OT")
plt.plot(uot_itr[t:], uot_mmd[t:], label="UOT")
plt.xlabel('Iteration')
plt.ylabel('MMD')
plt.title('Trainging samples:{}, Test samples:{}'.format(100, 4000))
plt.legend()
plt.show()

# 4000,100
ot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
ot_mmd=[0.11135312914848328, 0.0342942476272583, 0.010619819164276123, 0.0050051212310791016, 0.019507110118865967, 0.01035153865814209, 0.009773612022399902, 0.009276032447814941, 0.004798829555511475, 0.0024560093879699707, 0.028100550174713135, 0.0042337775230407715, 0.006272673606872559, 0.006193757057189941, 0.009284675121307373, 0.004370510578155518, 0.003981173038482666, 0.003247857093811035, 0.014632582664489746, 0.005276501178741455, 0.01121896505355835, 0.003038346767425537, 0.009407758712768555, 0.0043485164642333984, 0.006246984004974365, 0.00478971004486084, 0.007796347141265869, 0.004111766815185547, 0.004781126976013184, 0.010699748992919922, 0.009970307350158691, 0.004018008708953857, 0.008785724639892578, 0.02291935682296753, 0.00658649206161499, 0.007432997226715088, 0.012964367866516113, 0.00578916072845459, 0.005007147789001465, 0.0035246610641479492, 0.01013869047164917, 0.009206593036651611, 0.005638182163238525, 0.01110774278640747, 0.0074808597564697266, 0.014590859413146973, 0.006663978099822998, 0.006367206573486328, 0.002406895160675049, 0.0060710906982421875]
uot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
uot_mmd=[0.199143648147583, 0.048872143030166626, 0.009032070636749268, 0.018514156341552734, 0.012276113033294678, 0.006674766540527344, 0.00850677490234375, 0.004516243934631348, 0.016467034816741943, 0.012463867664337158, 0.0070456862449646, 0.004501819610595703, 0.007708847522735596, 0.007093191146850586, 0.005892336368560791, 0.0010826587677001953, 0.009479343891143799, 0.009869635105133057, 0.0020702481269836426, 0.0033907294273376465, 0.011622726917266846, 0.004999876022338867, 0.007036387920379639, 0.0029227733612060547, 0.004864811897277832, 0.004565298557281494, 0.011671662330627441, 0.00844883918762207, 0.002059042453765869, 0.0012999176979064941, 0.011928260326385498, 0.004179835319519043, 0.012796103954315186, 0.0037949085235595703, 0.0031782984733581543, 0.006876349449157715, 0.008867442607879639, 0.007861077785491943, 0.011031389236450195, 0.009075522422790527, 0.0016020536422729492, 0.011949896812438965, 0.004351139068603516, 0.006379842758178711, 0.004968881607055664, 0.0015770196914672852, 0.008954942226409912, 0.008014082908630371, 0.003042459487915039, 0.004432201385498047]

t=5
plt.plot(ot_itr[t:], ot_mmd[t:], label="OT")
plt.plot(uot_itr[t:], uot_mmd[t:], label="UOT")
plt.xlabel('Iteration')
plt.ylabel('MMD')
plt.title('Trainging samples:{}, Test samples:{}'.format(4000, 100))
plt.legend()
plt.show()

# 100,100
ot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
ot_mmd=[0.23507267236709595, 0.0377846360206604, 0.04619097709655762, 0.0785629153251648, 0.030684828758239746, 0.023583710193634033, 0.024608075618743896, 0.05220389366149902, 0.052648305892944336, 0.034529268741607666, 0.022588074207305908, 0.023114502429962158, 0.023655951023101807, 0.014851987361907959, 0.009470045566558838, 0.0061789751052856445, 0.02108389139175415, 0.0072515010833740234, 0.012761831283569336, 0.023714959621429443, 0.02049499750137329, 0.02293294668197632, 0.00881338119506836, 0.016461968421936035, 0.0021474361419677734, 0.0251656174659729, 0.01319807767868042, 0.018368124961853027, 0.03108847141265869, 0.009380877017974854, 0.01381152868270874, 0.027460217475891113, 0.028546631336212158, 0.011705756187438965, 0.007456660270690918, 0.006048798561096191, 0.009836435317993164, 0.03459668159484863, 0.005061686038970947, 0.015456914901733398, 0.010969698429107666, 0.0614510178565979, 0.030686497688293457, 0.04346054792404175, 0.04133403301239014, 0.007878363132476807, 0.006993770599365234, 0.015130698680877686, 0.011868715286254883, 0.006552278995513916]

uot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
uot_mmd=[0.14625677466392517, 0.07098010182380676, 0.045166015625, 0.010779738426208496, 0.033324241638183594, 0.008133888244628906, 0.01415342092514038, 0.015031814575195312, 0.028024733066558838, 0.028770148754119873, 0.006181478500366211, 0.010141253471374512, 0.007446944713592529, 0.006069302558898926, 0.004736483097076416, 0.07146358489990234, 0.004915773868560791, 0.015483319759368896, 0.020875513553619385, 0.010066092014312744, 0.0032599568367004395, 0.0023827552795410156, 0.0154876708984375, 0.032965004444122314, 0.015652120113372803, 0.028639674186706543, 0.01717609167098999, 0.004471182823181152, 0.008136510848999023, 0.021555840969085693, 0.023017823696136475, 0.008357226848602295, 0.024678289890289307, 0.01682257652282715, 0.017598509788513184, 0.012524306774139404, 0.008150160312652588, 0.009679079055786133, 0.00408405065536499, 0.012092292308807373, 0.02427905797958374, 0.009514331817626953, 0.01277703046798706, 0.011864006519317627, 0.01244431734085083, 0.011793851852416992, 0.006273984909057617, 0.019291698932647705, 0.0047692060470581055, 0.0028463006019592285]

t=5
plt.plot(ot_itr[t:], ot_mmd[t:], label="OT")
plt.plot(uot_itr[t:], uot_mmd[t:], label="UOT")
plt.xlabel('Iteration')
plt.ylabel('MMD')
plt.title('Trainging samples:{}, Test samples:{}'.format(100, 100))
plt.legend()
plt.show()

# About time

# 4000,4000

ot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
ot_mmd=[0.1466543972492218, 0.03195995092391968, 0.01452791690826416, 0.01574087142944336, 0.0020700693130493164, 0.0006865262985229492, 0.0006726980209350586, 0.001564323902130127, 0.0006436705589294434, 0.0005462765693664551, 0.0008603930473327637, 0.0005286335945129395, 0.0004942417144775391, 0.0003857612609863281, 0.0007582306861877441, 0.0005104541778564453, 0.0004604458808898926, 0.0005424618721008301, 0.0006911158561706543, 0.00042998790740966797, 0.0006124973297119141, 0.0005235671997070312, 0.000991225242614746, 0.0007452964782714844, 0.0011626482009887695, 0.001561582088470459, 0.000805974006652832, 0.0006641149520874023, 0.0003154277801513672, 0.0007059574127197266, 0.0006235241889953613, 0.0005404949188232422, 0.0004799962043762207, 0.0008425116539001465, 0.0008344650268554688, 0.0007688403129577637, 0.0008950233459472656, 0.000821232795715332, 0.0004477500915527344, 0.00048530101776123047, 0.0011799931526184082, 0.0005846023559570312, 0.0008982419967651367, 0.0006244778633117676, 0.0009093880653381348, 0.0016376972198486328, 0.0006906986236572266, 0.0005365610122680664, 0.0010680556297302246, 0.0004984736442565918]
ot_time=[1.2883944511413574, 2.279294967651367, 3.301910638809204, 4.331119537353516, 5.329669237136841, 6.3603904247283936, 7.364925861358643, 8.376952648162842, 9.397395849227905, 10.401896476745605, 11.441107988357544, 12.469217777252197, 13.4905526638031, 14.487645864486694, 15.500224113464355, 16.5091814994812, 17.507054090499878, 18.497732639312744, 19.499003410339355, 20.546190977096558, 21.590861797332764, 22.615198373794556, 23.60974669456482, 24.606919288635254, 25.601873874664307, 26.624704837799072, 27.61453604698181, 28.626261711120605, 29.62008237838745, 30.619444370269775, 31.68817663192749, 32.6884822845459, 33.68415093421936, 34.687498569488525, 35.68205380439758, 36.67365002632141, 37.672478675842285, 38.670302391052246, 39.6704785823822, 40.65865707397461, 41.700679302215576, 42.69584536552429, 43.69205331802368, 44.68686056137085, 45.67663931846619, 46.679900884628296, 47.67294144630432, 48.664949893951416, 49.65168213844299, 50.6413197517395]

uot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
uot_mmd=[0.15655335783958435, 0.02855217456817627, 0.0032210946083068848, 0.004938066005706787, 0.0008602738380432129, 0.0029234886169433594, 0.0044272541999816895, 0.0018603801727294922, 0.0003113746643066406, 0.0033416748046875, 0.0008789300918579102, 0.0004976987838745117, 0.0018997788429260254, 0.0006669163703918457, 0.00016295909881591797, 0.00014477968215942383, 0.0008354783058166504, 0.00023806095123291016, 0.0010254383087158203, 0.00039952993392944336, 0.0016574859619140625, 0.0025336742401123047, 0.0004507899284362793, 0.0005549788475036621, 0.0013614892959594727, 0.00020945072174072266, 0.00022089481353759766, 0.0008611083030700684, 0.0004076361656188965, 0.00018984079360961914, 0.0003091096878051758, 0.0009928345680236816, 0.0006148219108581543, 0.000737607479095459, 0.0007486939430236816, 0.0004578828811645508, 0.00040262937545776367, 0.0005966424942016602, 0.0008352398872375488, 0.0005478262901306152, 0.0004975199699401855, 0.0003272891044616699, 0.0004267096519470215, 0.0001614093780517578, 0.0007688999176025391, 0.0012527108192443848, 0.0003070831298828125, 0.00011420249938964844, 0.0004755258560180664, 0.0006334781646728516]
uot_time=[1.823695421218872, 3.328568458557129, 4.76021146774292, 6.192760467529297, 7.6076788902282715, 9.022470712661743, 10.448761940002441, 11.861177206039429, 13.29314398765564, 14.750365018844604, 16.18832302093506, 17.618459939956665, 19.028188228607178, 20.472349405288696, 21.887781620025635, 23.302118062973022, 24.7283353805542, 26.159745693206787, 27.592190504074097, 29.00502109527588, 30.42476534843445, 31.84198021888733, 33.24760675430298, 34.66523241996765, 36.076338052749634, 37.49420189857483, 38.9235520362854, 40.33847618103027, 41.745678186416626, 43.162580728530884, 44.590352296829224, 46.003576040267944, 47.423827171325684, 48.858760833740234, 50.299017906188965, 51.706573247909546, 53.12292695045471, 54.532302379608154, 55.96271204948425, 57.390148878097534, 58.81395101547241, 60.22048830986023, 61.635382413864136, 63.06773900985718, 64.48549103736877, 65.86494064331055, 67.25473642349243, 68.63242244720459, 70.01852869987488, 71.41776204109192]

t=5
plt.plot(ot_time[t:], ot_mmd[t:], label="OT")
plt.plot(uot_time[t:int(5/7*len(uot_mmd))], uot_mmd[t:int(5/7*len(uot_mmd))], label="UOT")
plt.xlabel('Time')
plt.ylabel('MMD')
plt.title('Trainging samples:{}, Test samples:{}'.format(4000, 4000))
plt.legend()
plt.show()

# 4000,100

ot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
ot_mmd=[0.18922671675682068, 0.10619714856147766, 0.05800926685333252, 0.08288520574569702, 0.013703227043151855, 0.004785299301147461, 0.003268718719482422, 0.007014811038970947, 0.00676274299621582, 0.0025042295455932617, 0.004175961017608643, 0.005717933177947998, 0.0022794008255004883, 0.008328437805175781, 0.0007120370864868164, 0.004163146018981934, 0.012771189212799072, 0.007826805114746094, 0.011996448040008545, 0.006727159023284912, 0.009761691093444824, 0.0028704404830932617, 0.003282606601715088, 0.0076073408126831055, 0.009555220603942871, 0.0028825998306274414, 0.0028728246688842773, 0.0025017857551574707, 0.009243547916412354, 0.004253089427947998, 0.008824825286865234, 0.00216597318649292, 0.002963244915008545, 0.00940018892288208, 0.005882203578948975, 0.0032859444618225098, 0.003933370113372803, 0.010103702545166016, 0.008263587951660156, 0.0021392107009887695, 0.0014129281044006348, 0.00825732946395874, 0.011662960052490234, 0.007157564163208008, 0.0176393985748291, 0.01697075366973877, 0.007063508033752441, 0.0026918649673461914, 0.005431473255157471, 0.011401772499084473]
ot_time=[1.1329796314239502, 2.015821695327759, 2.9000563621520996, 3.7708969116210938, 4.759957790374756, 5.654850006103516, 6.547346830368042, 7.429453372955322, 8.306089878082275, 9.208179235458374, 10.125075578689575, 11.03855562210083, 11.92648458480835, 12.800148248672485, 13.678122520446777, 14.554735898971558, 15.459058284759521, 16.339611768722534, 17.21724820137024, 18.10628628730774, 19.073991775512695, 19.936044454574585, 20.82428526878357, 21.694629669189453, 22.585800170898438, 23.467944622039795, 24.34622812271118, 25.23470711708069, 26.100578546524048, 26.99018669128418, 27.891557931900024, 28.78142762184143, 29.67067575454712, 30.55637502670288, 31.42881202697754, 32.30109429359436, 33.16950440406799, 34.062780141830444, 34.95118546485901, 35.85475254058838, 36.81767201423645, 37.7479031085968, 38.65508556365967, 39.56747913360596, 40.488868951797485, 41.40934133529663, 42.31258773803711, 43.21253180503845, 44.14427900314331, 45.041138648986816]

uot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
uot_mmd=[0.13041791319847107, 0.01891249418258667, 0.018590688705444336, 0.006626129150390625, 0.006053447723388672, 0.012273192405700684, 0.0071440935134887695, 0.010180115699768066, 0.01089411973953247, 0.007569313049316406, 0.009065687656402588, 0.012544214725494385, 0.014909565448760986, 0.0034297704696655273, 0.0028409361839294434, 0.004059433937072754, 0.008461833000183105, 0.02028822898864746, 0.012819886207580566, 0.006562173366546631, 0.012292802333831787, 0.02773231267929077, 0.009176492691040039, 0.005443930625915527, 0.00620800256729126, 0.003889024257659912, 0.008505165576934814, 0.005037248134613037, 0.0178106427192688, 0.005730867385864258, 0.021860241889953613, 0.013033568859100342, 0.011838376522064209, 0.005448102951049805, 0.006695091724395752, 0.004918277263641357, 0.0029065608978271484, 0.014256536960601807, 0.006120741367340088, 0.002274155616760254, 0.004424333572387695, 0.005407512187957764, 0.0112227201461792, 0.01121985912322998, 0.004683494567871094, 0.006454825401306152, 0.008552312850952148, 0.007881104946136475, 0.0056343674659729, 0.023789703845977783]
uot_time=[1.772852897644043, 3.2534453868865967, 4.69646143913269, 6.110816240310669, 7.5365471839904785, 8.958786010742188, 10.402865648269653, 11.807916641235352, 13.234998226165771, 14.711488485336304, 16.150617361068726, 17.57362699508667, 19.021238327026367, 20.43827486038208, 21.87660574913025, 23.34325385093689, 24.789044857025146, 26.223305702209473, 27.648805141448975, 29.079655170440674, 30.510448455810547, 31.94037938117981, 33.35621237754822, 34.782909631729126, 36.198023319244385, 37.61420941352844, 39.05347776412964, 40.46749210357666, 41.89658570289612, 43.33031749725342, 44.7736656665802, 46.21485185623169, 47.648773431777954, 49.07343864440918, 50.51372456550598, 51.94371247291565, 53.36981201171875, 54.78756833076477, 56.24584245681763, 57.655911684036255, 59.04788160324097, 60.4496545791626, 61.839656829833984, 63.23162078857422, 64.61285948753357, 65.99469184875488, 67.38824963569641, 68.78301811218262, 70.19517159461975, 71.62343192100525]

t=5
plt.plot(ot_time[t:], ot_mmd[t:], label="OT")
plt.plot(uot_time[t:int(5/7*len(uot_mmd))], uot_mmd[t:int(5/7*len(uot_mmd))], label="UOT")
plt.xlabel('Time')
plt.ylabel('MMD')
plt.title('Trainging samples:{}, Test samples:{}'.format(4000, 100))
plt.legend()
plt.show()

# 100,100

ot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
ot[0.21832039952278137, 0.061648398637771606, 0.02202814817428589, 0.008864104747772217, 0.010128796100616455, 0.004263877868652344, 0.004458189010620117, 0.04378765821456909, 0.005234241485595703, 0.012431085109710693, 0.02117389440536499, 0.012690305709838867, 0.015817463397979736, 0.01237022876739502, 0.011648595333099365, 0.009826302528381348, 0.009536564350128174, 0.015863120555877686, 0.041506409645080566, 0.01786971092224121, 0.02532482147216797, 0.0183866024017334, 0.03923201560974121, 0.006777286529541016, 0.007467985153198242, 0.0021578073501586914, 0.0037973523139953613, 0.0108109712600708, 0.009570121765136719, 0.010460317134857178, 0.0032774806022644043, 0.005524039268493652, 0.018292725086212158, 0.017140984535217285, 0.008172690868377686, 0.012647569179534912, 0.024814367294311523, 0.009424924850463867, 0.007683277130126953, 0.009072840213775635, 0.01032954454421997, 0.01471787691116333, 0.005179643630981445, 0.010542690753936768, 0.019412100315093994, 0.009314417839050293, 0.027799606323242188, 0.009835124015808105, 0.017359435558319092, 0.01676696538925171]
[1.1981096267700195, 2.20314884185791, 3.218086004257202, 4.231595516204834, 5.253650665283203, 6.260220766067505, 7.268835783004761, 8.266864538192749, 9.253452777862549, 10.239351511001587, 11.358144044876099, 12.37467336654663, 13.385053634643555, 14.405138492584229, 15.405466556549072, 16.392843008041382, 17.373291015625, 18.363176822662354, 19.360140562057495, 20.34122133255005, 21.34675645828247, 22.357115030288696, 23.3662371635437, 24.39973735809326, 25.414687871932983, 26.437623977661133, 27.34622836112976, 28.2027690410614, 29.037007808685303, 29.873840808868408, 30.759118795394897, 31.59326720237732, 32.44062829017639, 33.29265999794006, 34.13266730308533, 34.96957492828369, 35.810307264328, 36.6412353515625, 37.48339509963989, 38.33475041389465, 39.196518421173096, 40.03376793861389, 40.88193082809448, 41.75184369087219, 42.60348725318909, 43.44199466705322, 44.30570721626282, 45.14682197570801, 46.01713013648987, 46.876299142837524]

uot_itr=[10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500]
uot_mmd=[0.21722161769866943, 0.13259202241897583, 0.051732003688812256, 0.018935680389404297, 0.015694260597229004, 0.010587453842163086, 0.014150381088256836, 0.017806828022003174, 0.02102506160736084, 0.023372888565063477, 0.036479413509368896, 0.04729056358337402, 0.053498923778533936, 0.045653581619262695, 0.029385745525360107, 0.017792880535125732, 0.01309359073638916, 0.07729250192642212, 0.030625998973846436, 0.04706680774688721, 0.024027884006500244, 0.012838959693908691, 0.00897294282913208, 0.026909172534942627, 0.019728779792785645, 0.04954463243484497, 0.009902417659759521, 0.03803890943527222, 0.04510301351547241, 0.016357123851776123, 0.015818238258361816, 0.009431540966033936, 0.019458472728729248, 0.041420161724090576, 0.015480875968933105, 0.0153084397315979, 0.018152296543121338, 0.021423697471618652, 0.014888882637023926, 0.008782446384429932, 0.004265725612640381, 0.015317678451538086, 0.03144848346710205, 0.011138379573822021, 0.012933671474456787, 0.0033307671546936035, 0.010545134544372559, 0.011200785636901855, 0.03414928913116455, 0.03466767072677612]
uot_time=[1.6700289249420166, 3.14105486869812, 4.522984981536865, 5.918517827987671, 7.288193702697754, 8.655011415481567, 10.080727577209473, 11.540958642959595, 12.945702075958252, 14.321618795394897, 15.711225748062134, 17.077787399291992, 18.442811012268066, 19.820435762405396, 21.18974256515503, 22.5612690448761, 23.943034887313843, 25.314636945724487, 26.687527418136597, 28.064903259277344, 29.44696545600891, 30.822659969329834, 32.20006513595581, 33.589683294296265, 34.96269750595093, 36.33176589012146, 37.70055341720581, 39.068172454833984, 40.43186116218567, 41.78918218612671, 43.16271209716797, 44.531598806381226, 45.884626626968384, 47.25228142738342, 48.6262629032135, 49.993271589279175, 51.36252999305725, 52.729809045791626, 54.12948513031006, 55.55148911476135, 56.892062187194824, 58.237396001815796, 59.577664613723755, 60.90835523605347, 62.25101637840271, 63.585127115249634, 64.93559670448303, 66.29370331764221, 67.63595271110535, 68.96044635772705]

t=5
plt.plot(ot_time[t:], ot_mmd[t:], label="OT")
plt.plot(uot_time[t:int(5/7*len(uot_mmd))], uot_mmd[t:int(5/7*len(uot_mmd))], label="UOT")
plt.xlabel('Time')
plt.ylabel('MMD')
plt.title('Trainging samples:{}, Test samples:{}'.format(100, 100))
plt.legend()
plt.show()
